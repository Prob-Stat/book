# エルゴード性

## 定常分布への収束

マルコフ連鎖が推移行列 $T$ を持つとする。
ある確率ベクトル $\mu\in\mathbb{R}_{\ge 0}^n$ が存在して、任意の確率ベクトル $\pi\in\mathbb{R}_{\ge0}^n$ について、
\begin{align*}
\lim_{t\to\infty} \pi T^t &= \mu
\end{align*}
が成り立つとき、**エルゴード的**であるという。
このとき、
\begin{align*}
\mu &= \lim_{t\to\infty} \pi T^{t}\\
&= \lim_{t\to\infty} \pi T^{t-1}T\\
&= \mu T
\end{align*}
より、収束先である $\mu$ は定常分布である。
初期分布が定常分布のとき、収束先は初期状態そのものである。
そのため、「エルゴード的 $\implies$ 定常分布は唯一」が成り立つ。
しかし、その逆は成り立たない。
例えば、推移行列が
\begin{align*}
T&=
\begin{bmatrix}
0&1\\1&0
\end{bmatrix}
\end{align*}
のとき、既約なマルコフ連鎖なので定常分布は唯一である。
唯一の定常確率ベクトルは $\begin{bmatrix}1/2&1/2\end{bmatrix}$ である。
しかし、初期分布が $\begin{bmatrix}1&0\end{bmatrix}$ のとき、
$\begin{bmatrix}1&0\end{bmatrix}$ と $\begin{bmatrix}0&1\end{bmatrix}$ を交互に遷移するため、エルゴード的ではないことが分かる。
初期分布が $\begin{bmatrix}1/2+\epsilon&1/2-\epsilon\end{bmatrix}$ のように定常分布に近い場合でも収束しない。
このことは $T$ の固有値が $\pm1$ であることから理解することができる。
<!-- これは二部グラフ $G=(\{1,2\},\{\{1,2\}\})$ 上のランダムウォークなので。-->

同様に
\begin{align*}
T&=
\begin{bmatrix}
0&1&0\\0&0&1\\1&0&0
\end{bmatrix}
\end{align*}
の場合も既約であり、唯一の定常分布 $\begin{bmatrix}1/3&1/3&1/3\end{bmatrix}$ を持つが、定常分布以外の分布からスタートすると収束しない。
この場合は固有値は $1, \mathrm{e}^{\frac{2\pi}{3}},\mathrm{e}^{\frac{4\pi}{3}}$ である。

## 周期
:::{#def-period}
## 状態の周期
マルコフ連鎖の状態 $s\in S$ について
\begin{align*}
d(i) &\coloneqq\mathrm{gcd}\left(\left\{n\ge0\mid T^n_{i,i}>0\right\}\right)
\end{align*}
:::

:::{#lem-period}
## 周期は不変
\begin{align*}
i\sim_T j&\implies d(i) = d(j)
\end{align*}
:::
