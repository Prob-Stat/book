[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "確率・統計入門",
    "section": "",
    "text": "前書き\nこれは確率論と統計学の入門書である。 確率論を数学的に取り扱うには通常は測度論とルベーグ積分を用いる。 本書では測度論を学ぶ前の数学専攻の学生を対象に確率論と統計学の基礎を解説する。 測度論とルベーグ積分を省略するため、しばしば積分と極限の交換などの等式を証明なしに用いる。 後で測度論を学んだ後にぜひ振り返って欲しい。",
    "crumbs": [
      "前書き"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  はじめに",
    "section": "",
    "text": "1.1 なぜ確率論と統計学を学ぶか？\nThis is a book created from markdown and executable code.\nSee Knuth (1984) for additional discussion of literate programming.",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>はじめに</span>"
    ]
  },
  {
    "objectID": "intro.html#本書の構成",
    "href": "intro.html#本書の構成",
    "title": "1  はじめに",
    "section": "1.2 本書の構成",
    "text": "1.2 本書の構成",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>はじめに</span>"
    ]
  },
  {
    "objectID": "intro.html#その他の参考文献",
    "href": "intro.html#その他の参考文献",
    "title": "1  はじめに",
    "section": "1.3 その他の参考文献",
    "text": "1.3 その他の参考文献\n\n\n\n\nKnuth, Donald E. 1984. “Literate Programming.” Comput. J. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>はじめに</span>"
    ]
  },
  {
    "objectID": "prob-space.html",
    "href": "prob-space.html",
    "title": "3  確率空間",
    "section": "",
    "text": "3.1 確率論を数学的に定式化するには\n確率は身近に現れる(感じられる)ものであるが、それを数学的に定式化することは自明な問題ではない。 実際に確率論には複数の数学的定式化が存在する。 その中で圧倒的に一般的なのが測度論的確率論と呼ばれる定式化である。 測度というのは集合の「面積」のようなものであり、確率を測度と捉えるのが測度論的確率論である。 これは多くの人間の直感にも自然なものであろう。\nまず、確率を考える集合について考えよう。 例えばコインを投げて表もしくは裏が出る確率を考えたいときは \\[\n\\Omega = \\{\\mathrm{H},\\,\\mathrm{T}\\}\n\\] という集合になる。 また、明日の天気の確率を考えたいときは \\[\n\\Omega = \\{\\text{\"晴\"},\\, \\text{\"雨\"},\\, \\text{\"雪\"}\\}\n\\] という集合になるだろう。 この \\(\\Omega\\) の部分集合に確率を与える関数 \\(P\\colon 2^\\Omega\\to\\mathbb{R}\\) を定義しよう。 偏りのないコインの場合は以下のようになる。 \\[\\begin{align*}\nP(\\varnothing) &= 0,& P(\\{\\mathrm{H}\\}) &= \\frac12,&\nP(\\{\\mathrm{T}\\}) &= \\frac12,& P(\\{\\mathrm{H},\\,\\mathrm{T}\\}) &= 1.\n\\end{align*}\\] また、天気の場合は例えば以下のようになる。 \\[\\begin{align*}\nP(\\varnothing)&=0,& P(\\{晴\\})&=0.7,& P(\\{雨\\})&=0.2,& P(\\{雪\\})&=0.1\\\\\nP(\\{晴,雨\\})&=0.9,& P(\\{雨,雪\\})&=0.3,& P(\\{雪,晴\\})&=0.8,&P(\\{晴,雨,雪\\})&=1.\n\\end{align*}\\]\nこのように集合 \\(\\Omega\\) の部分集合に確率を与えることを考える。 \\(\\Omega\\) の要素一つずつに確率を与えれば十分であるようにも思えるが、\\(\\Omega\\) が連続的な場合には \\(\\Omega\\) の一つの要素の確率は 0 になってしまうことが多い。 例えば明日の正午の気温が \\(10\\pi \\,{}^\\circ\\mathrm{C}\\) になる確率は 0 であろう。 そのため、\\(\\Omega\\) の要素ではなく部分集合に確率を与えることにする。 そのために測度論が適しているわけである。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "prob-space.html#有限集合上の確率空間",
    "href": "prob-space.html#有限集合上の確率空間",
    "title": "3  確率空間",
    "section": "3.2 有限集合上の確率空間",
    "text": "3.2 有限集合上の確率空間\n確率を考える集合を \\(\\Omega\\) とする。 この \\(\\Omega\\) のことを標本空間という。 また、\\(\\Omega\\) の部分集合のことを事象という。 そして、事象に確率を与える関数 \\(P\\colon 2^\\Omega\\to\\mathbb{R}_{\\ge 0}\\) を確率測度という。 確率測度は以下の条件を満たす。\n\n\\(P(\\Omega)=1\\).\n\\(\\forall A,\\,B\\subseteq\\Omega,\\quad A\\cap B = \\varnothing \\implies P(A\\cup B) = P(A) + P(B)\\).\n\n一つ目の条件は全体の確率が1であるという意味の条件である。 二つ目の条件は排反な二つの事象の和集合の確率はそれぞれの事象の確率の和であるという意味の条件である。 この二つ目の条件を有限加法性という。 例えば \\[\nP(\\{\\text{\"晴\"}, \\text{\"雨\"}\\}) = P(\\{\\text{\"晴\"}\\}) + P(\\{\\text{\"雨\"}\\})\n\\] という等式は「晴れもしくは雨になる確率 \\(=\\) 晴れになる確率 \\(+\\) 雨になる確率」という意味の等式になる。 よって有限加法性が自然な条件であることが分かるだろう。 また、これらのことから、\\(P\\) は各要素 \\(\\omega\\in\\Omega\\) に対する確率 \\(P(\\{\\omega\\})\\) から一意に定まることが分かる。 この標本空間と確率測度のペア \\((\\Omega,\\, P)\\) を確率空間という。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "prob-space.html#可算無限集合上の確率",
    "href": "prob-space.html#可算無限集合上の確率",
    "title": "3  確率空間",
    "section": "3.3 可算無限集合上の確率",
    "text": "3.3 可算無限集合上の確率\n標本空間 \\(\\Omega\\) が可算無限集合のときも、同様に確率測度を定義することもできるが、ここではより強い以下の条件を考える。\n\n\\(P(\\Omega)=1\\).\n\\(\\forall (A_n\\subseteq \\Omega)_{n\\ge 0},\\quad \\forall i\\ne j,\\, A_i\\cap A_j=\\varnothing\\implies P\\left(\\bigcup_{n\\ge 0}A_n\\right) = \\sum_{n\\ge 0} P(A_n)\\).\n\nこの二つ目の条件を完全加法性もしくは \\(\\sigma\\)-加法性という。 ここで \\[\n\\bigcup_{n\\ge 0} A_n = \\{\\omega\\in\\Omega\\mid \\exists n\\ge 0,\\, \\omega\\in A_n\\}\n\\] は事象列 \\((A_n)_{n\\ge 0}\\) の並び順に依存しない。 よって、\\(P\\) の完全加法性が成り立つとき \\[\n\\sum_{n\\ge 0} P(A_n)\n\\] も事象列 \\((A_n)_{n\\ge 0}\\) の並び順に依存しない。 そもそも \\(P(A_n)\\ge 0\\) なので、無限和 \\(\\sum_{n\\ge 0} P(A_n)\\) が存在するときこれは絶対収束することから、この無限和は事象列の並び順に依存しないことが分かる。 完全加法性ではなく有限加法性だけを使って確率論を構築する試みもあるが、確率測度の連続性などの性質が失なわれるため 標準的な確率論では完全加法性を課す。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "prob-space.html#すべての部分集合を可測にはできない",
    "href": "prob-space.html#すべての部分集合を可測にはできない",
    "title": "3  確率空間",
    "section": "3.4 すべての部分集合を可測にはできない",
    "text": "3.4 すべての部分集合を可測にはできない\nより一般に \\(\\Omega\\) が非可算無限集合の場合を考えよう。例えば \\(\\Omega = [0, 1)\\) の場合が考えられる。 このとき、すべての \\(A\\subseteq\\Omega\\) に確率を与えることができるのだろうか？ そうすると、ごく自然な性質を持つような確率測度が存在しないことが、選択公理を認めると示される。\n\n定理 3.1 (非可測集合の存在) \\(\\Omega=[0,1)\\) とする。 また、集合の平行移動を \\[\nA+x\\coloneqq\\{a+x-\\lfloor a+x\\rfloor\\mid a\\in A\\}\n\\] と定義する。 このとき、 \\[\n\\forall x\\in\\Omega,\\, A\\subseteq\\Omega,\\quad P(A+x) = P(A)\\qquad\\text{(平行移動不変性)}\n\\] を満たす確率測度 \\(P\\colon 2^{[0,1)}\\to \\mathbb{R}_{\\ge 0}\\) は存在しない。\n\n\n証明. \\(\\Omega\\) 上の同値関係を \\(x\\sim y \\stackrel{\\mathrm{def}}{\\iff} x-y\\in\\mathbb{Q}\\) と定義する。 選択公理より、この同値関係の同値類から一つずつ要素を含む集合 \\(V\\) が存在する(Vitali集合)。 任意の \\(x\\in[0, 1)\\) について、ある \\(z\\in V\\) が唯一存在して \\(x\\sim z\\) である。 よって、任意の \\(x\\in[0, 1)\\) について、ある \\(z\\in V\\) と \\(q\\in\\mathbb{Q}\\) が唯一存在して \\(x = z+q\\) であることから \\[\\begin{align*}\n[0, 1) &= \\bigcup_{q\\in\\mathbb{Q}} (V + q)\n\\end{align*}\\] であり、右辺は互いに排反である。 よって条件を満たす \\(P\\) が存在すると仮定すると、 \\[\\begin{align*}\n1 = P([0, 1)) &= P\\left(\\bigcup_{q\\in\\mathbb{Q}} (V+q)\\right)\\\\\n&= \\sum_{q\\in\\mathbb{Q}} P\\left(V+q\\right)\\qquad \\text{(完全加法性)}\\\\\n&= \\sum_{q\\in\\mathbb{Q}} P\\left(V\\right)\\qquad \\text{(平行移動不変性)}\n\\end{align*}\\] ここで \\(P(V)\\) をどのように定めても、それを無限回足して 1 にすることはできない。 よって \\(P\\) は存在しない。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "prob-space.html#確率論の公理",
    "href": "prob-space.html#確率論の公理",
    "title": "3  確率空間",
    "section": "3.5 確率論の公理",
    "text": "3.5 確率論の公理\n定理 3.1 より、\n\n選択公理\n確率測度の完全加法性\n\\([0, 1)\\) 上の平行移動不変な確率測度\n\\(\\Omega\\) のすべての部分集合に確率を与える\n\nのどれかを諦めないといけない。 標準的な確率論では4を諦める。 以下に確率空間の厳密な定義を述べる。\n\n定義 3.1 (完全加法族) \\(\\Omega\\) を集合とする。 \\(\\mathcal{F}\\subseteq 2^\\Omega\\) が以下を満たすとする。\n\n\\(\\Omega\\in\\mathcal{F}\\).\n\\(\\forall A\\in\\mathcal{F},\\quad \\Omega\\setminus A\\in\\mathcal{F}\\).\n\\(\\forall (A_n\\in\\mathcal{F})_{n\\ge 0},\\quad \\bigcup_{n\\ge 0} A_n\\in\\mathcal{F}\\).\n\nこのとき、\\(\\mathcal{F}\\) を \\(\\Omega\\) 上の完全加法族もしくは \\(\\sigma\\)-加法族という。\n\n\n定義 3.2 (確率空間) \\(\\Omega\\) を集合とし、 \\(\\mathcal{F}\\subseteq 2^\\Omega\\) を \\(\\Omega\\) 上の完全加法族とする。\nまた、\\(P\\colon\\mathcal{F}\\to\\mathbb{R}_{\\ge 0}\\) が以下を満たすとする。\n\n\\(P(\\Omega)=1\\).\n\\(\\forall (A_n\\in \\mathcal{F})_{n\\ge 0},\\quad \\forall i\\ne j,\\, A_i\\cap A_j=\\varnothing\\implies P\\left(\\bigcup_{n\\ge 0}A_n\\right) = \\sum_{n\\ge 0} P(A_n)\\).\n\nこのとき、\\((\\Omega,\\, \\mathcal{F},\\, P)\\) を確率空間という。 また、\\(\\Omega\\) を標本空間、\\(\\mathcal{F}\\) を事象集合、\\(P\\) を確率測度という。\n\nこのように事象集合 \\(\\mathcal{F}\\) の元についてのみ確率が与えられる。\n\n\n\n\n\n\nノート\n\n\n\nペア \\((\\Omega,\\, \\mathcal{F})\\) を可測空間という。 確率空間 \\((\\Omega,\\, \\mathcal{F},\\, P)\\) から \\(P(\\Omega)=1\\) の条件を除いたものが一般の測度空間である。\n\n\n定理 3.1 の証明では選択公理を用いたが、実際に選択公理を認めないと 定理 3.1 が成立しないことが分かっている。 以降、\\(\\Omega\\) が非可算無限集合である場合も含めて、\\(\\mathcal{F} = 2^\\Omega\\) だと思うことにする。 これは正しくない場合もあるのだが、選択公理を使わない限り矛盾は導かれないので、問題になることはほとんどない。 よって、以降は \\((\\Omega,\\, P)\\) を確率空間とする。\n\\(\\Omega = [0, 1)\\) で任意の \\(0\\le a &lt; b\\le 1\\) について \\(P([a, b)) = b-a\\) であるような確率空間はとても基本的なものである。 今後この性質を満たす確率空間が存在すると仮定して話を進める。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "prob-space.html#確率の性質",
    "href": "prob-space.html#確率の性質",
    "title": "3  確率空間",
    "section": "3.6 確率の性質",
    "text": "3.6 確率の性質\n\n補題 3.1 (確率のいくつかの性質) 確率空間 \\((\\Omega,\\, P)\\) と任意の \\(A,\\,B\\subseteq \\Omega\\) について以下が成り立つ。 ただし、\\(A^c = \\Omega\\setminus A\\) とする。\n\n\\(P(A^c) = 1 - P(A)\\).\n\\(B\\subseteq A\\implies P(B)\\le P(A)\\)\n\\(P(A\\cup B) = P(A) + P(B) - P(A\\cap B)\\).\n\\(P(A\\cup B) \\le P(A) + P(B)\\) (ブールの不等式、union bound).\n\n\n\n証明. \n\n\\[\n1 = P(\\Omega) = P(A \\cup A^c) = P(A) + P(A^c).\n\\]\n\\[\nP(A) = P(B\\cup (A\\setminus B)) = P(B) + P(A\\setminus B) \\ge P(B).\n\\]\n\\[\\begin{align*}\nP(A\\cup B) &= P(A \\cup (B\\setminus A)) = P(A) + P(B\\setminus A)\\\\\nP(B) &= P((B\\setminus A) \\cup (A\\cap B)) = P(B\\setminus A) + P(A\\cap B)\n\\end{align*}\\] より、 \\(P(B\\setminus A)\\) を消去することで得られる。\n3 より自明\n\n\n\n補題 3.2 (ユニオンバウンド) 確率空間 \\((\\Omega,\\, P)\\) と \\((A_n\\subseteq\\Omega)_{n\\ge 0}\\) について、 \\[\nP\\left(\\bigcup_{n\\ge 0} A_n\\right) \\le \\sum_{n\\ge 0} P(A_n)\n\\]\n\n\n証明. \\(B_0 \\coloneqq A_0\\), \\(B_n \\coloneqq A_n \\setminus \\bigcup_{k=0}^{n-1} A_k\\) とおくと、\n\\[\\begin{align*}\nP\\left(\\bigcup_{n\\ge 0} A_n\\right) &= P\\left(\\bigcup_{n\\ge 0} B_n\\right)\\\\\n&= \\sum_{n\\ge 0} P\\left(B_n\\right)\\\\\n&\\le \\sum_{n\\ge 0} P\\left(A_n\\right)\n\\end{align*}\\]\n\n\n定理 3.2 (確率測度の連続性) 確率空間 \\((\\Omega,\\, P)\\) と事象列 \\(A_0\\subseteq A_1\\subseteq \\dotsb \\subseteq \\Omega\\) について \\[\\begin{align*}\nP\\left(\\bigcup_{k=1}^\\infty A_k\\right) = \\lim_{n\\to\\infty} P(A_n).\n\\end{align*}\\]\n\n\n証明. \\(B_0\\coloneqq A_0\\), \\(n\\ge 1\\)について\\(B_n\\coloneqq A_n\\setminus A_{n-1}\\)とおく。 このとき、\\(i\\ne j\\)について \\(B_i\\cap B_j=\\varnothing\\)。また、\\(\\bigcup_{k=1}^n B_k = \\bigcup_{k=1}^nA_k = A_n\\).\n\\[\\begin{align*}\nP\\left(\\bigcup_{k=1}^\\infty A_k\\right)&= P\\left(\\bigcup_{k=1}^\\infty B_k\\right) =\\sum_{k=1}^\\infty P(B_k)\\\\\n&=\\lim_{n\\to\\infty} \\sum_{k=1}^n P(B_k)\n=\\lim_{n\\to\\infty} P\\left(\\bigcup_{k=1}^n B_k\\right)\n=\\lim_{n\\to\\infty} P(A_n).\n\\end{align*}\\]",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "prob-space.html#条件付き確率",
    "href": "prob-space.html#条件付き確率",
    "title": "3  確率空間",
    "section": "3.7 条件付き確率",
    "text": "3.7 条件付き確率",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "rv.html",
    "href": "rv.html",
    "title": "4  確率変数と確率分布",
    "section": "",
    "text": "4.1 確率変数\n確率空間の上の様々な部分集合の確率を調べたい。 そのためには確率変数を導入すると便利である。\n任意の関数 \\(f\\colon \\mathbb{R}\\to\\mathbb{R}\\) について \\(f\\circ X\\) は確率変数である。 このとき、\\(\\Pr(f\\circ X \\in A)\\) と書く代わりに \\(\\Pr(f(X)\\in A)\\) と書く。\n共通の確率空間 \\((\\Omega,\\, P)\\) 上の確率変数 \\(X,\\,Y\\) についてその和 \\(X + Y\\) や積 \\(XY\\) も確率変数である。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率変数と確率分布</span>"
    ]
  },
  {
    "objectID": "rv.html#確率変数",
    "href": "rv.html#確率変数",
    "title": "4  確率変数と確率分布",
    "section": "",
    "text": "定義 4.1 (確率変数) 確率空間 \\((\\Omega,\\, P)\\) について、 関数 \\(X\\colon \\Omega\\to\\mathbb{R}\\) を確率変数という。\nまた、任意の \\(A\\subseteq\\mathbb{R}\\) について \\[\n\\Pr(X\\in A) \\coloneqq P(\\{\\omega\\in\\Omega\\mid X(\\omega)\\in A\\})\n\\] と定義する。 さらに、任意の \\(a\\in\\mathbb{R}\\) について \\[\n\\Pr(X\\ge a) \\coloneqq P(X\\in \\{x\\in\\mathbb{R}\\mid x\\ge a\\}) = P(\\{\\omega\\in\\Omega\\mid X(\\omega)\\ge a\\})\n\\] と定義する。 同様に \\(\\Pr(X &gt; a),\\, \\Pr(X \\le a),\\, \\Pr(X &lt; a),\\, \\Pr(X = a)\\) なども定義される。\n\n\n\n\n\n\n\nノート\n\n\n\n本当の確率論では確率変数は「確率空間から位相空間への写像で開集合の逆像が可測集合になるような関数」として定義される。 また、文献によっては確率変数は「確率空間から可測空間への写像で可測集合の逆像が可測集合になるような関数」として定義されることもある。 開集合族が生成する完全加法族をボレル集合族と呼ぶが、この方法で位相空間から可測空間を作ることができる。 そうすると前者の定義は「確率空間から位相空間への写像でボレル集合の逆像が可測集合になるような関数」と等価なので、後者の定義に含まれる。 後者の定義の中の可測空間が位相空間由来のものに限定したのが前者の定義であると言える。\n\n\n\n\n\n\n\n\n\nノート\n\n\n\n本当の確率論の言葉で述べると任意のボレル関数(開集合(ボレル集合としても等価)の逆像がボレル集合となる関数) \\(f\\) について \\(f\\circ X\\) は確率変数である。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率変数と確率分布</span>"
    ]
  },
  {
    "objectID": "rv.html#確率分布",
    "href": "rv.html#確率分布",
    "title": "4  確率変数と確率分布",
    "section": "4.2 確率分布",
    "text": "4.2 確率分布\n確率変数 \\(X\\) の像が高々可算のとき、\\(X\\) を離散型確率変数という。 離散型確率変数でない確率変数を連続型確率変数という。\n\\(X\\) が離散型確率変数のとき、\\(A\\) を \\(X\\) の像の部分集合とすると\n\\[\\begin{align*}\n\\Pr(X\\in A) &= \\Pr\\left(\\{\\omega\\in\\Omega\\mid X(\\omega)\\in A\\}\\right)\\\\\n&= \\Pr\\left(\\bigcup_{x\\in A} \\{\\omega\\in\\Omega\\mid X(\\omega)=x\\}\\right)\\\\\n&= \\sum_{x\\in A} \\Pr\\left(\\{\\omega\\in\\Omega\\mid X(\\omega)=x\\}\\right)\\\\\n&= \\sum_{x\\in A} \\Pr\\left(X=x\\right)\n\\end{align*}\\]\nであるので、\n\\[\nf_X(x) \\coloneqq \\Pr(X=x) \\qquad \\forall x\\in\\mathbb{R}\n\\]\nという関数を用いて \\[\n\\Pr(X\\in A) = \\sum_{x\\in A} f_X(x)\n\\] と表せる。 この \\(f_X(x)\\) を \\(X\\) の確率質量関数という。\n\\(X\\) が連続型確率変数のとき、\n\\[\\begin{align*}\n\\Pr(X\\in A) &= \\int_{x\\in A} f_X(x) \\mathrm{d}x\\qquad\\forall A\\subseteq\\mathbb{R}\n\\end{align*}\\]\nを満たす \\(f_X\\colon\\mathbb{R}\\to\\mathbb{R}\\) が存在するとき、この \\(f_X(x)\\) を \\(X\\) の確率密度関数という。 しかし、確率密度関数は常に存在するとは限らない。\n\n例 4.1 \\(\\Omega = [0, 1)\\)とし、\\(P\\colon 2^\\Omega\\to\\mathbb{R}_{\\ge 0}\\) を \\(P([a, b)) = b-a\\) を満たす確率測度とする。 確率空間 \\((\\Omega,\\, P)\\) 上の確率変数 \\(X\\colon [0,1)\\to\\mathbb{R}\\) を \\[\nX(\\omega) =\n\\begin{cases}\n2\\omega& \\text{if }\\omega &lt; \\frac12\\\\\n\\frac12& \\text{otherwise.}\n\\end{cases}\n\\] と定義する。\nこの時 \\(X\\) の像は \\([0,1)\\) であるので \\(X\\) は連続型確率変数である。\nまた、\\(\\Pr(X=\\frac12) = P([\\frac12, 1)\\cup\\{\\frac14\\}) = \\frac12\\) である。 よって \\(X\\) の確率密度関数は存在しない。\n\n一方で、任意の確率変数 \\(X\\) について\n\\[\nF_X(x) \\coloneqq \\Pr(X\\le x)\\qquad\\forall x\\in\\mathbb{R}\n\\]\nを確率変数 \\(X\\) の累積分布関数という。 累積分布関数は常に存在する。 連続確率変数 \\(X\\) が確率密度関数を持つとき、\n\\[\nF_X(x) = \\int_{-\\infty}^x f_X(y) \\mathrm{d}y\n\\]\nという関係が成り立つ。 よって\n\\[\nf_X(x) = \\frac{\\mathrm{d}F_X}{\\mathrm{d}x}\n\\]\nとおいても構わない。確率密度関数はその積分値にのみ意味を持つ。そのため確率密度関数は一意には定まらない。\n累積分布関数は定義より単調非減少関数であることが分かる。 累積分布関数は連続とは限らないが右連続であることは以下のように確認できる。\n\\[\\begin{align*}\n\\lim_{n\\to\\infty} \\Pr\\left(X \\le x + \\frac1n\\right) &=\n\\lim_{n\\to\\infty} \\Pr\\left(\\left\\{\\omega\\mid X(\\omega) \\le x + \\frac1n\\right\\}\\right)\\\\\n&= \\Pr\\left(\\bigcap_{n=0}^\\infty \\left\\{\\omega\\mid X(\\omega) \\le x + \\frac1n\\right\\}\\right)\\\\\n&= \\Pr\\left(\\left\\{\\omega\\mid X(\\omega) \\le x\\right\\}\\right)\n\\end{align*}\\]\n例 4.1 の確率変数 \\(X\\) の確率密度関数は\n\n\nコード\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# xの範囲を定義（-1から2までを細かく分けて計算）\nx = np.linspace(-0.5, 1.5, 1000)\n\n# 区間ごとの関数定義\ny = np.piecewise(\n    x,\n    [x &lt; 0,\n     (0 &lt;= x) & (x &lt; 0.5),\n     (0.5 &lt;= x) & (x &lt; 1),\n     x &gt;= 1],\n    [0,\n     lambda x: x / 2,\n     lambda x: x / 2 + 0.5,\n     1]\n)\n\n# グラフの描画\nplt.figure(figsize=(8, 5))\nplt.plot(x, y, label='$F_X(x)$', color='blue')\nplt.title('Cpf of $X$')\nplt.xlabel('$x$')\nplt.ylabel('$F_X(x)$')\nplt.grid(True)\nplt.axhline(0, color='black', linewidth=0.5)\nplt.axvline(0, color='black', linewidth=0.5)\n\n# x = 1/2 の左極限（穴あき）\nx_left = 0.5 - 1e-5  # 少しだけ左\ny_left = x_left / 2\nplt.plot(0.5, y_left, 'o', color='white', markeredgecolor='blue', markersize=8)\n\n# x = 1/2 の値（右からの定義値）\ny_right = 0.5 / 2 + 0.5\nplt.plot(0.5, y_right, 'o', color='blue', markersize=6)\n\nplt.show()\n\n\n\n\n\n\n\n\n図 4.1: \\(X\\)の累積分布関数",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率変数と確率分布</span>"
    ]
  },
  {
    "objectID": "rv.html#確率分布の例",
    "href": "rv.html#確率分布の例",
    "title": "4  確率変数と確率分布",
    "section": "4.3 確率分布の例",
    "text": "4.3 確率分布の例\n\n4.3.1 二項分布\n二項分布の確率質量関数は\n\n\nコード\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom scipy.stats import binom\n\n# パラメータの設定\nn = 12       # 試行回数\np = 0.6      # 成功確率\n\n# 取りうる値の範囲\nx = np.arange(0, n+1)\n\n# 二項分布のPMFの計算\npmf = binom.pmf(x, n, p)\n\n# プロット\nplt.figure(figsize=(8, 5))\nplt.bar(x, pmf, tick_label=x)\nplt.title(f'Pmf of binomial distribution with n={n}, p={p}')\nplt.xlabel('$k$')\nplt.ylabel('$\\\\Pr(X=k)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\n\n\n\n\n\n\n\n図 4.2: 二項分布の確率質量関数",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率変数と確率分布</span>"
    ]
  },
  {
    "objectID": "moments.html",
    "href": "moments.html",
    "title": "5  期待値、分散、モーメント",
    "section": "",
    "text": "定義 5.1 (期待値) 離散確率変数 \\(X\\) が\\(A\\subseteq\\mathbb{R}\\)に値を取るとき、その期待値は\n\\[\n\\expt{X}= \\sum_{x\\in A} f_X(x) x\n\\]\nと定義される。ここで、右辺の和が絶対収束しない場合は期待値は定義されない。 連続確率変数 \\(X\\) が確率密度関数 \\(f_X\\) を持つとき、その期待値は\n\\[\n\\expt{X}= \\int_{-\\infty}^\\infty f_X(x) x \\mathrm{d}x\n\\]\nと定義される。\n\n\n定理 5.1 (マルコフの不等式) 非負確率変数 \\(X\\) と \\(a&gt;0\\) について \\[\n\\Pr(X\\ge a)\\le\\frac{\\expt{X}}{a}\n\\]\n\n\n証明. \\[\\begin{align*}\n\\expt{X} &= \\sum_{x\\in A} f_X(x) x\\\\\n&= \\sum_{x\\ge a} f_X(x) x + \\sum_{x &lt; a} f_X(x) x\\\\\n&\\ge \\sum_{x\\ge a} f_X(x) x\\qquad\\qquad (X\\ge 0)\\\\\n&\\ge \\sum_{x\\ge a} f_X(x) a\\\\\n&= \\Pr(X\\ge a) a\\\\\n\\end{align*}\\]",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>期待値、分散、モーメント</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "参考文献",
    "section": "",
    "text": "Knuth, Donald E. 1984. “Literate Programming.” Comput.\nJ. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "参考文献"
    ]
  }
]