[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "確率・統計入門",
    "section": "",
    "text": "前書き\nこれは確率論と統計学の入門書である。 確率論を数学的に取り扱うには通常は測度論とルベーグ積分を用いる。 本書では測度論を学ぶ前の数学専攻の学生を対象に確率論と統計学の基礎を解説する。 測度論とルベーグ積分を省略するため、しばしば積分と極限の交換などの等式を証明なしに用いる。 後で測度論を学んだ後にぜひ振り返って欲しい。",
    "crumbs": [
      "前書き"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  はじめに",
    "section": "",
    "text": "1.1 なぜ確率論と統計学を学ぶか？\nThis is a book created from markdown and executable code.\nSee Knuth (1984) for additional discussion of literate programming.",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>はじめに</span>"
    ]
  },
  {
    "objectID": "intro.html#本書の構成",
    "href": "intro.html#本書の構成",
    "title": "1  はじめに",
    "section": "1.2 本書の構成",
    "text": "1.2 本書の構成",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>はじめに</span>"
    ]
  },
  {
    "objectID": "intro.html#その他の参考文献",
    "href": "intro.html#その他の参考文献",
    "title": "1  はじめに",
    "section": "1.3 その他の参考文献",
    "text": "1.3 その他の参考文献\n\n\n\n\nKnuth, Donald E. 1984. “Literate Programming.” Comput. J. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>はじめに</span>"
    ]
  },
  {
    "objectID": "sets.html",
    "href": "sets.html",
    "title": "2  集合論",
    "section": "",
    "text": "2.1 集合\n集合は対象の集まりである。例えば \\[\\begin{align*}\nA&=\\{1,2,3\\},& B&=\\{赤,青,黄,緑\\}\n\\end{align*}\\] のように表す。 集合を構成するものを要素もしくは元という。\nを表す。\n\\(|A|\\) で集合 \\(A\\) の要素数を表すことにする。 要素数が無限の集合を考えることもできる。 例えば \\[\\begin{align*}\nA&=\\{n\\in\\mathbb{N}\\mid \\text{$n$ は偶数}\\},& B&=\\{x\\in\\mathbb{R}\\mid \\text{$x$ は無理数} \\}\n\\end{align*}\\]\nという集合は無限集合の例となる。 何も要素を持たない集合(要素数が零の集合)を空集合といい、\\(\\varnothing\\) で表す。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>集合論</span>"
    ]
  },
  {
    "objectID": "sets.html#集合",
    "href": "sets.html#集合",
    "title": "2  集合論",
    "section": "",
    "text": "\\(x\\in A\\) で要素 \\(x\\) は集合 \\(A\\) に含まれる\n\\(x\\notin A\\) で要素 \\(x\\) は集合 \\(A\\) に含まれない",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>集合論</span>"
    ]
  },
  {
    "objectID": "sets.html#集合の関係",
    "href": "sets.html#集合の関係",
    "title": "2  集合論",
    "section": "2.2 集合の関係",
    "text": "2.2 集合の関係\n集合 \\(A\\) の要素がすべて集合 \\(B\\) に含まれるとき、\\(A\\) を \\(B\\) の部分集合 という。 部分集合に関連する集合関係について記号を以下のように定義する。 \\[\\begin{align*}\nA\\subseteq B &\\defiff \\forall x\\,(x\\in A\\implies x \\in B)&\\text{($A$ は $B$ の部分集合)}\\\\\nA\\supseteq B &\\defiff B\\subseteq A&\\text{($A$ は $B$ の上位集合)}\\\\\nA = B &\\defiff (A\\subseteq B\\land A\\supseteq B)& \\text{($A$ と $B$ は等しい)}\\\\\nA \\ne B &\\defiff \\lnot(A = B)& \\text{($A$ と $B$ は等しくない)}\n\\end{align*}\\]\nまた、 \\[\\begin{align*}\nA\\subsetneq B &\\defiff (A\\subseteq B \\land A\\ne B)&\\text{($A$ は $B$ の真部分集合)}\\\\\nA\\supsetneq B &\\defiff B\\subsetneq A&\\text{($A$ は $B$ の真上位集合)}\n\\end{align*}\\]\nとする。 部分集合や上位集合のような集合間の関係を包含関係という。 集合 \\(A,\\,B\\) について、\\(A\\subseteq B\\) と \\(B\\subseteq A\\) のどちらかが成り立つとき、「\\(A\\) と \\(B\\) の間に包含関係が成り立つ」という。\n包含関係は以下の三条件を満たす。\n\n(反射律) \\(\\quad A\\subseteq A\\).\n(反対称律) \\(\\quad (A\\subseteq B\\land B\\subseteq A) \\iff A = B\\).\n(推移律) \\(\\quad (A\\subseteq B\\land B\\subseteq C)\\implies A\\subseteq C\\).",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>集合論</span>"
    ]
  },
  {
    "objectID": "sets.html#集合の演算",
    "href": "sets.html#集合の演算",
    "title": "2  集合論",
    "section": "2.3 集合の演算",
    "text": "2.3 集合の演算\n複数の集合から新しい集合を作る演算がある。 \\[\\begin{align*}\nA\\cup B &\\coloneqq\\left\\{x\\mid x\\in A \\textsf{ または } x \\in B\\right\\}\\qquad\\textsf{(和集合)}\\\\\nA\\cap B &\\coloneqq \\left\\{x\\mid x\\in A \\textsf{ かつ } x \\in B\\right\\}\\qquad\\textsf{(積集合)}\\\\\nA\\setminus B &\\coloneqq \\left\\{x\\mid x\\in A \\textsf{ かつ } x \\notin B\\right\\}\\qquad\\textsf{(差集合)}\n\\end{align*}\\]\nこれらの演算は以下の法則を満たす。\n\n(交換法則) \\(\\quad A\\cup B = B\\cup A, \\quad A\\cap B = B\\cap A\\).\n(結合法則) \\(\\quad (A\\cup B)\\cup C = A\\cup (B\\cup C), \\quad (A\\cap B)\\cap C=A\\cap(B\\cap C)\\).\n(分配法則) \\(\\quad A\\cup(B\\cap C) = (A\\cup B)\\cap (A\\cup C),\\quad A\\cap (B\\cup C) = (A\\cap B)\\cup (A\\cap C)\\).\n(冪等法則) \\(\\quad A \\cup A = A, \\quad A\\cap A = A\\).\n(吸収法則) \\(\\quad A \\cup (A\\cap B) = A, \\quad A\\cap (A\\cup B) = A\\).\n\\(A\\cup \\varnothing = A,\\quad A\\cap\\varnothing = \\varnothing\\).\n\n和集合と積集合は結合法則満たすことから、括弧を使わずに \\(A\\cup B\\cup C\\) と表すことができる。 集合 \\(A\\) と \\(B\\) が \\(A\\cap B=\\varnothing\\) を満たすとき、確率論文脈では、「\\(A\\) と \\(B\\) は排反である」(集合論文脈では「互いに素である」)という。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>集合論</span>"
    ]
  },
  {
    "objectID": "sets.html#補集合",
    "href": "sets.html#補集合",
    "title": "2  集合論",
    "section": "2.4 補集合",
    "text": "2.4 補集合\n全体の集合 \\(\\Omega\\) というのが文脈上存在する場合は、 \\[\\begin{align*}\nA^\\mathrm{c} &\\coloneqq \\Omega\\setminus A\\qquad\\textsf{(補集合)}\n\\end{align*}\\]\nと定義する。\n補集合に関連して以下の法則が成り立つ。\n\n\\(\\Omega^\\mathrm{c} = \\varnothing,\\quad \\varnothing^\\mathrm{c} = \\Omega\\).\n\\(A\\cup \\Omega = \\Omega,\\quad A\\cap\\Omega = A\\).\n\\(A\\cup A^\\mathrm{c} = \\Omega,\\quad A\\cap A^\\mathrm{c} =\\varnothing\\).\n(二重補集合の法則) \\(\\quad (A^\\mathrm{c})^\\mathrm{c} = A\\).\n(ド・モルガンの法則) \\(\\quad(A\\cup B)^\\mathrm{c} = A^\\mathrm{c} \\cap B^\\mathrm{c},\\quad(A\\cap B)^\\mathrm{c} = A^\\mathrm{c} \\cup B^\\mathrm{c}\\)",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>集合論</span>"
    ]
  },
  {
    "objectID": "sets.html#集合族",
    "href": "sets.html#集合族",
    "title": "2  集合論",
    "section": "2.5 集合族",
    "text": "2.5 集合族\n集合 \\(\\Omega\\) について \\(2^\\Omega\\) を \\(\\Omega\\) のすべての部分集合からなる集合を表す。 \\[\\begin{align*}\n2^\\Omega &\\coloneqq \\left\\{A\\subseteq\\Omega\\right\\}.\n\\end{align*}\\]\nこれを \\(\\Omega\\) の冪集合という。 例えば \\(\\Omega=\\{1,2,3\\}\\) のとき、\n\\[\n2^\\Omega = \\left\\{\\varnothing, \\{1\\}, \\{2\\}, \\{3\\}, \\{1,2\\},\\{2,3\\},\\{1,3\\},\\{1,2,3\\}\\right\\}\n\\]\nである。 \\(\\Omega\\) が有限集合のとき、\\(|2^\\Omega|=2^{|\\Omega|}\\) が成り立つ。 また、\\(2^\\Omega\\) の部分集合を \\(\\Omega\\) 上の(部分)集合族と呼ぶ。 集合 \\(\\Lambda\\) の各 \\(\\lambda\\in\\Lambda\\) に対して集合 \\(A_\\lambda\\subseteq\\Omega\\) が存在するとき、集合族\n\\[\n\\left\\{A_\\lambda\\subseteq\\Omega\\mid \\lambda\\in\\Lambda\\right\\}\\subseteq 2^\\Omega\n\\]\nを添字集合 \\(\\Lambda\\) で添字付けられた \\(\\Omega\\) 上の集合族という。 添字集合が有限集合の場合は集合族全体の和集合や積集合は二つの集合の和集合と積集合の定義を繰り返し用いることで定義できる。 それらは以下のように表す。\n\\[\n\\bigcup_{\\lambda\\in\\Lambda} A_\\lambda \\quad,\\quad\n\\bigcap_{\\lambda\\in\\Lambda} A_\\lambda.\n\\]\n添字集合 \\(\\Lambda\\) が無限集合の場合は和集合と積集合を以下で定義する。 \\[\\begin{align*}\n\\bigcup_{\\lambda\\in\\Lambda} A_\\lambda\n&\\coloneqq\n\\left\\{x\\in\\Omega\\mid \\exists \\lambda\\in\\Lambda,\\quad x\\in A_\\lambda\\right\\}\\\\\n\\bigcap_{\\lambda\\in\\Lambda} A_\\lambda\n&\\coloneqq\n\\left\\{x\\in\\Omega\\mid \\forall \\lambda\\in\\Lambda,\\quad x\\in A_\\lambda\\right\\}\n\\end{align*}\\]\nこの定義は \\(\\Lambda\\) が有限集合の場合も正しいものである。 この場合もド・モルガンの法則は成り立つ。つまり、 \\[\\begin{align*}\n\\left(\\bigcup_{\\lambda\\in\\Lambda} A_\\lambda\\right)^\\mathrm{c}\n&=\n\\bigcap_{\\lambda\\in\\Lambda} A_\\lambda^\\mathrm{c}\\\\\n\\left(\\bigcap_{\\lambda\\in\\Lambda} A_\\lambda\\right)^\\mathrm{c}\n&=\n\\bigcup_{\\lambda\\in\\Lambda} A_\\lambda^\\mathrm{c}\n\\end{align*}\\]\nが成り立つ。\n証明: \\(x\\in\\Omega\\) について、 \\[\\begin{align*}\nx\\in\\left(\\bigcup_{\\lambda\\in\\Lambda} A_\\lambda\\right)^\\mathrm{c}\n&\\iff x\\notin\\left(\\bigcup_{\\lambda\\in\\Lambda} A_\\lambda\\right)\\\\\n&\\iff \\lnot\\left(\\exists\\lambda\\in\\Lambda,\\quad x\\in A_\\lambda\\right)\\\\\n&\\iff \\forall\\lambda\\in\\Lambda,\\quad x\\notin A_\\lambda\\\\\n&\\iff \\forall\\lambda\\in\\Lambda,\\quad x\\in A_\\lambda^\\mathrm{c}\\\\\n&\\iff x\\in\\bigcap_{\\lambda\\in\\Lambda} A_\\lambda^{\\mathrm{c}}.\n\\end{align*}\\]",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>集合論</span>"
    ]
  },
  {
    "objectID": "prob-space.html",
    "href": "prob-space.html",
    "title": "3  確率空間",
    "section": "",
    "text": "3.1 確率論を数学的に定式化するには\n確率は身近に現れる(感じられる)ものであるが、それを数学的に定式化することは自明な問題ではない。 実際に確率論には複数の数学的定式化が存在する。 その中で圧倒的に一般的なのが測度論的確率論と呼ばれる定式化である。 測度というのは集合の「面積」のようなものであり、確率を測度と捉えるのが測度論的確率論である。 これは多くの人間の直感にも自然なものであろう。\nまず、確率を考える集合について考えよう。 例えばコインを投げて表もしくは裏が出る確率を考えたいときは \\[\n\\Omega = \\{\\mathrm{H},\\,\\mathrm{T}\\}\n\\] という集合になる。 また、明日の天気の確率を考えたいときは \\[\n\\Omega = \\{\\text{\"晴\"},\\, \\text{\"雨\"},\\, \\text{\"雪\"}\\}\n\\] という集合になるだろう。 この \\(\\Omega\\) の部分集合に確率を与える関数 \\(P\\colon 2^\\Omega\\to\\mathbb{R}\\) を定義しよう。 偏りのないコインの場合は以下のようになる。 \\[\\begin{align*}\nP(\\varnothing) &= 0,& P(\\{\\mathrm{H}\\}) &= \\frac12,&\nP(\\{\\mathrm{T}\\}) &= \\frac12,& P(\\{\\mathrm{H},\\,\\mathrm{T}\\}) &= 1.\n\\end{align*}\\] また、天気の場合は例えば以下のようになる。 \\[\\begin{align*}\nP(\\varnothing)&=0,& P(\\{晴\\})&=0.7,& P(\\{雨\\})&=0.2,& P(\\{雪\\})&=0.1\\\\\nP(\\{晴,雨\\})&=0.9,& P(\\{雨,雪\\})&=0.3,& P(\\{雪,晴\\})&=0.8,&P(\\{晴,雨,雪\\})&=1.\n\\end{align*}\\]\nこのように集合 \\(\\Omega\\) の部分集合に確率を与えることを考える。 \\(\\Omega\\) の要素一つずつに確率を与えれば十分であるようにも思えるが、\\(\\Omega\\) が連続的な場合には \\(\\Omega\\) の一つの要素の確率は 0 になってしまうことが多い。 例えば明日の正午の気温が \\(10\\pi \\,{}^\\circ\\mathrm{C}\\) になる確率は 0 であろう。 そのため、\\(\\Omega\\) の要素ではなく部分集合に確率を与えることにする。 そのために測度論が適しているわけである。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "prob-space.html#有限集合上の確率空間",
    "href": "prob-space.html#有限集合上の確率空間",
    "title": "3  確率空間",
    "section": "3.2 有限集合上の確率空間",
    "text": "3.2 有限集合上の確率空間\n確率を考える集合を \\(\\Omega\\) とする。 この \\(\\Omega\\) のことを標本空間という。 また、\\(\\Omega\\) の部分集合のことを事象という。 そして、事象に確率を与える関数 \\(P\\colon 2^\\Omega\\to\\mathbb{R}_{\\ge 0}\\) を確率測度という。 確率測度は以下の条件を満たす。\n\n\\(P(\\Omega)=1\\).\n\\(\\forall A,\\,B\\subseteq\\Omega,\\quad A\\cap B = \\varnothing \\implies P(A\\cup B) = P(A) + P(B)\\).\n\n一つ目の条件は全体の確率が1であるという意味の条件である。 二つ目の条件は排反な二つの事象の和集合の確率はそれぞれの事象の確率の和であるという意味の条件である。 この二つ目の条件を有限加法性という。 例えば \\[\nP(\\{\\text{\"晴\"}, \\text{\"雨\"}\\}) = P(\\{\\text{\"晴\"}\\}) + P(\\{\\text{\"雨\"}\\})\n\\] という等式は「晴れもしくは雨になる確率 \\(=\\) 晴れになる確率 \\(+\\) 雨になる確率」という意味の等式になる。 よって有限加法性が自然な条件であることが分かるだろう。 また、これらのことから、\\(P\\) は各要素 \\(\\omega\\in\\Omega\\) に対する確率 \\(P(\\{\\omega\\})\\) から一意に定まることが分かる。 この標本空間と確率測度のペア \\((\\Omega,\\, P)\\) を確率空間という。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "prob-space.html#可算無限集合上の確率",
    "href": "prob-space.html#可算無限集合上の確率",
    "title": "3  確率空間",
    "section": "3.3 可算無限集合上の確率",
    "text": "3.3 可算無限集合上の確率\n標本空間 \\(\\Omega\\) が可算無限集合のときも、同様に確率測度を定義することもできるが、ここではより強い以下の条件を考える。\n\n\\(P(\\Omega)=1\\).\n\\(\\forall (A_n\\subseteq \\Omega)_{n\\ge 0},\\quad \\forall i\\ne j,\\, A_i\\cap A_j=\\varnothing\\implies P\\left(\\bigcup_{n\\ge 0}A_n\\right) = \\sum_{n\\ge 0} P(A_n)\\).\n\nここで二つ目の条件における \\({}_{n\\ge 0}\\) という添字において \\(n\\) は非負整数全体をわたる。 今後もこの記法を用いる。 この二つ目の条件を完全加法性もしくは \\(\\sigma\\)-加法性という。 右辺の無限和において \\(P(A_n)\\ge 0\\) なので、無限和 \\(\\sum_{n\\ge 0} P(A_n)\\) が存在するときこれは絶対収束する。 よって、この無限和は事象列の並び順に依存しないことが分かる。 完全加法性ではなく有限加法性だけを使って確率論を構築する試みもあるが、確率測度の連続性などの性質が失なわれるため 標準的な確率論では完全加法性を課す。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "prob-space.html#すべての部分集合を可測にはできない",
    "href": "prob-space.html#すべての部分集合を可測にはできない",
    "title": "3  確率空間",
    "section": "3.4 すべての部分集合を可測にはできない",
    "text": "3.4 すべての部分集合を可測にはできない\nより一般に \\(\\Omega\\) が非可算無限集合の場合を考えよう。例えば \\(\\Omega = [0, 1)\\) の場合が考えられる。 このとき、すべての \\(A\\subseteq\\Omega\\) に確率を与えることができるのだろうか？ そうすると、ごく自然な性質を持つような確率測度が存在しないことが、選択公理を認めると示される。\n\n定理 3.1 (非可測集合の存在) \\(\\Omega=[0,1)\\) とする。 また、集合の平行移動を \\[\nA+x\\coloneqq\\{a+x-\\lfloor a+x\\rfloor\\mid a\\in A\\}\n\\] と定義する。 このとき、 \\[\n\\forall x\\in\\Omega,\\, A\\subseteq\\Omega,\\quad P(A+x) = P(A)\\qquad\\textsf{(平行移動不変性)}\n\\] を満たす確率測度 \\(P\\colon 2^{[0,1)}\\to \\mathbb{R}_{\\ge 0}\\) は存在しない。\n\n\n証明. \\(\\Omega\\) 上の同値関係を \\(x\\sim y \\stackrel{\\mathrm{def}}{\\iff} x-y\\in\\mathbb{Q}\\) と定義する。 選択公理より、この同値関係の同値類から一つずつ要素を含む集合 \\(V\\) が存在する(Vitali集合)。 任意の \\(x\\in[0, 1)\\) について、ある \\(z\\in V\\) が唯一存在して \\(x\\sim z\\) である。 よって、任意の \\(x\\in[0, 1)\\) について、ある \\(z\\in V\\) と \\(q\\in\\mathbb{Q}\\cap[0,1)\\) が唯一存在して \\(x = z+q-\\lfloor z+q\\rfloor\\) であることから \\[\\begin{align*}\n[0, 1) &= \\bigcup_{q\\in\\mathbb{Q}\\cap[0,1)} (V + q)\n\\end{align*}\\] であり、右辺は互いに排反である。 よって条件を満たす \\(P\\) が存在すると仮定すると、 \\[\\begin{align*}\n1 = P([0, 1)) &= P\\left(\\bigcup_{q\\in\\mathbb{Q}\\cap[0,1)} (V+q)\\right)\\\\\n&= \\sum_{q\\in\\mathbb{Q}\\cap[0,1)} P\\left(V+q\\right)\\qquad \\textsf{(完全加法性)}\\\\\n&= \\sum_{q\\in\\mathbb{Q}\\cap[0,1)} P\\left(V\\right)\\qquad \\textsf{(平行移動不変性)}\n\\end{align*}\\] ここで \\(P(V)\\) をどのように定めても、それを無限回足して 1 にすることはできない。 よって \\(P\\) は存在しない。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "prob-space.html#確率論の公理",
    "href": "prob-space.html#確率論の公理",
    "title": "3  確率空間",
    "section": "3.5 確率論の公理",
    "text": "3.5 確率論の公理\n定理 3.1 より、\n\n選択公理\n確率測度の完全加法性\n\\([0, 1)\\) 上の平行移動不変な確率測度\n\\(\\Omega\\) のすべての部分集合に確率を与える\n\nのどれかを諦めないといけない。 標準的な確率論では4を諦める。 以下に確率空間の厳密な定義を述べる。\n\n定義 3.1 (完全加法族) \\(\\Omega\\) を集合とする。 \\(\\Omega\\) 上の集合族 \\(\\mathcal{F}\\subseteq 2^\\Omega\\) が以下を満たすとする。\n\n\\(\\Omega\\in\\mathcal{F}\\).\n\\(\\forall A\\in\\mathcal{F},\\quad A^\\mathrm{c} = \\Omega\\setminus A\\in\\mathcal{F}\\).\n\\(\\forall (A_n\\in\\mathcal{F})_{n\\ge 0},\\quad \\bigcup_{n\\ge 0} A_n\\in\\mathcal{F}\\).\n\nこのとき、\\(\\mathcal{F}\\) を \\(\\Omega\\) 上の完全加法族もしくは \\(\\sigma\\)-加法族という。\n\n\n定義 3.2 (確率空間) \\(\\Omega\\) を集合とし、 \\(\\mathcal{F}\\subseteq 2^\\Omega\\) を \\(\\Omega\\) 上の完全加法族とする。\nまた、\\(P\\colon\\mathcal{F}\\to\\mathbb{R}_{\\ge 0}\\) が以下を満たすとする。\n\n\\(P(\\Omega)=1\\).\n\\(\\forall (A_n\\in \\mathcal{F})_{n\\ge 0},\\quad \\forall i\\ne j,\\, A_i\\cap A_j=\\varnothing\\implies P\\left(\\bigcup_{n\\ge 0}A_n\\right) = \\sum_{n\\ge 0} P(A_n)\\).\n\nこのとき、\\((\\Omega,\\, \\mathcal{F},\\, P)\\) を確率空間という。 また、\\(\\Omega\\) を標本空間、\\(\\mathcal{F}\\) を事象集合、\\(P\\) を確率測度という。\n\nこのように事象集合 \\(\\mathcal{F}\\) の元についてのみ確率が与えられる。\n\n\n\n\n\n\nノート\n\n\n\nペア \\((\\Omega,\\, \\mathcal{F})\\) を可測空間という。 確率空間 \\((\\Omega,\\, \\mathcal{F},\\, P)\\) から \\(P(\\Omega)=1\\) の条件を除いたものが一般の測度空間である。\n\n\n定理 3.1 の証明では選択公理を用いたが、実際に選択公理を認めないと 定理 3.1 が成立しないことが分かっている。 以降、\\(\\Omega\\) が非可算無限集合である場合も含めて、\\(\\mathcal{F} = 2^\\Omega\\) だと思うことにする。 これは正しくない場合もあるのだが、選択公理を使わない限り矛盾は導かれないので、問題になることはほとんどない。 よって、以降は \\((\\Omega,\\, P)\\) を確率空間とする。\n\\(\\Omega = [0, 1)\\) で任意の \\(0\\le a &lt; b\\le 1\\) について \\(P([a, b)) = b-a\\) であるような確率空間はとても基本的なものである。 今後この性質を満たす確率空間が存在すると仮定して話を進める。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "prob-space.html#確率の性質",
    "href": "prob-space.html#確率の性質",
    "title": "3  確率空間",
    "section": "3.6 確率の性質",
    "text": "3.6 確率の性質\n\n補題 3.1 (確率のいくつかの性質) 確率空間 \\((\\Omega,\\, P)\\) と任意の \\(A,\\,B\\subseteq \\Omega\\) について以下が成り立つ。\n\n\\(P(A^\\mathrm{c}) = 1 - P(A)\\).\n\\(B\\subseteq A\\implies P(B)\\le P(A)\\)\n\\(P(A\\cup B) = P(A) + P(B) - P(A\\cap B)\\).\n\\(P(A\\cup B) \\le P(A) + P(B)\\qquad\\) (ブールの不等式、union bound).\n\n\n\n証明. \n\n\\[\n1 = P(\\Omega) = P(A \\cup A^\\mathrm{c}) = P(A) + P(A^\\mathrm{c}).\n\\]\n\\[\nP(A) = P(B\\cup (A\\setminus B)) = P(B) + P(A\\setminus B) \\ge P(B).\n\\]\n\\[\\begin{align*}\nP(A\\cup B) &= P(A \\cup (B\\setminus A)) = P(A) + P(B\\setminus A)\\\\\nP(B) &= P((B\\setminus A) \\cup (A\\cap B)) = P(B\\setminus A) + P(A\\cap B)\n\\end{align*}\\] より、 \\(P(B\\setminus A)\\) を消去することで得られる。\n3 より自明\n\n\n\n補題 3.2 (ユニオンバウンド) 確率空間 \\((\\Omega,\\, P)\\) と \\((A_n\\subseteq\\Omega)_{n\\ge 0}\\) について、 \\[\nP\\left(\\bigcup_{n\\ge 0} A_n\\right) \\le \\sum_{n\\ge 0} P(A_n).\n\\]\n\n\n証明. \\(B_0 \\coloneqq A_0\\), \\(B_n \\coloneqq A_n \\setminus \\bigcup_{k=0}^{n-1} A_k\\) とおくと、\n\\[\\begin{align*}\nP\\left(\\bigcup_{n\\ge 0} A_n\\right) &= P\\left(\\bigcup_{n\\ge 0} B_n\\right)\\\\\n&= \\sum_{n\\ge 0} P\\left(B_n\\right)\\\\\n&\\le \\sum_{n\\ge 0} P\\left(A_n\\right).\n\\end{align*}\\]\n\n\n定理 3.2 (確率測度の連続性) 確率空間 \\((\\Omega,\\, P)\\) と事象列 \\(A_0\\subseteq A_1\\subseteq \\dotsb \\subseteq \\Omega\\) について \\[\\begin{align*}\nP\\left(\\bigcup_{n\\ge 0} A_n\\right) = \\lim_{n\\to\\infty} P(A_n).\n\\end{align*}\\] また、事象列 \\(\\Omega\\supseteq A_0\\supseteq A_1\\supseteq \\dotsb\\) について \\[\\begin{align*}\nP\\left(\\bigcap_{n\\ge 0} A_n\\right) = \\lim_{n\\to\\infty} P(A_n).\n\\end{align*}\\]\n\n\n証明. 事象列 \\(A_0\\subseteq A_1\\subseteq \\dotsb \\subseteq \\Omega\\) について考える。 \\(B_0\\coloneqq A_0\\), \\(n\\ge 1\\)について\\(B_n\\coloneqq A_n\\setminus A_{n-1}\\)とおく。 このとき、\\(i\\ne j\\)について \\(B_i\\cap B_j=\\varnothing\\)。 また \\(k\\ge 0\\) について、\\(\\bigcup_{n=0}^k B_n = \\bigcup_{n=0}^kA_n = A_k\\) が成り立つ.\n\\[\\begin{align*}\nP\\left(\\bigcup_{n\\ge 0} A_n\\right)&= P\\left(\\bigcup_{n\\ge 0} B_n\\right) =\\sum_{n\\ge 0} P(B_n)\\\\\n&=\\lim_{k\\to\\infty} \\sum_{n=0}^k P(B_n)\n=\\lim_{k\\to\\infty} P\\left(\\bigcup_{n=0}^k B_n\\right)\n=\\lim_{k\\to\\infty} P(A_k).\n\\end{align*}\\]\n事象列 \\(\\Omega\\supseteq A_0\\supseteq A_1\\supseteq \\dotsb\\) について考える。 このとき、 \\(A'_n \\coloneqq A_n^\\mathrm{c}\\) とおくと、\\(A'_0\\subseteq A'_1\\subseteq \\dotsb \\subseteq \\Omega\\) を満たす。 よって、\n\\[\\begin{align*}\nP\\left(\\bigcup_{n\\ge 0} A'_n\\right) &= \\lim_{n\\to\\infty} P(A'_n)\n\\end{align*}\\]\nである。ド・モルガンの公式より、\n\\[\\begin{align*}\nP\\left(\\left(\\bigcap_{n\\ge 0} A_n\\right)^\\mathrm{c}\\right) &= \\lim_{n\\to\\infty} P(A^\\mathrm{c}_n)\\\\\n\\iff 1-P\\left(\\bigcap_{n\\ge 0} A_n\\right) &= \\lim_{n\\to\\infty} \\bigl( 1-P(A_n)\\bigr)\\\\\n\\iff P\\left(\\bigcap_{n\\ge 0} A_n\\right) &= \\lim_{n\\to\\infty} P(A_n).\n\\end{align*}\\]",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>確率空間</span>"
    ]
  },
  {
    "objectID": "rv.html",
    "href": "rv.html",
    "title": "4  確率変数と確率分布",
    "section": "",
    "text": "4.1 確率変数\n確率空間の上の様々な部分集合の確率を調べたい。 そのためには確率変数を導入すると便利である。\n任意の関数 \\(f\\colon \\mathbb{R}\\to\\mathbb{R}\\) について \\(f\\circ X\\) は確率変数である。 このとき、\\(\\Pr(f\\circ X \\in A)\\) と書く代わりに \\(\\Pr(f(X)\\in A)\\) と書く。\n共通の確率空間 \\((\\Omega,\\, P)\\) 上の確率変数 \\(X,\\,Y\\) についてその和 \\(X + Y\\) や積 \\(XY\\) も確率変数である。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率変数と確率分布</span>"
    ]
  },
  {
    "objectID": "rv.html#確率変数",
    "href": "rv.html#確率変数",
    "title": "4  確率変数と確率分布",
    "section": "",
    "text": "定義 4.1 (確率変数) 確率空間 \\((\\Omega,\\, P)\\) について、 関数 \\(X\\colon \\Omega\\to\\mathbb{R}\\) を確率変数という。\nまた、任意の \\(A\\subseteq\\mathbb{R}\\) について \\[\n\\Pr(X\\in A) \\coloneqq P(\\{\\omega\\in\\Omega\\mid X(\\omega)\\in A\\})\n\\] と定義する。 さらに、任意の \\(a\\in\\mathbb{R}\\) について \\[\n\\Pr(X\\ge a) \\coloneqq P(X\\in \\{x\\in\\mathbb{R}\\mid x\\ge a\\}) = P(\\{\\omega\\in\\Omega\\mid X(\\omega)\\ge a\\})\n\\] と定義する。 同様に \\(\\Pr(X &gt; a),\\, \\Pr(X \\le a),\\, \\Pr(X &lt; a),\\, \\Pr(X = a)\\) なども定義される。\n\n\n\n\n\n\n\nノート\n\n\n\n本当の確率論では確率変数は「確率空間から位相空間への写像で開集合の逆像が可測集合になるような関数」として定義される。 また、文献によっては確率変数は「確率空間から可測空間への写像で可測集合の逆像が可測集合になるような関数」として定義されることもある。 開集合族が生成する完全加法族をボレル集合族と呼ぶが、この方法で位相空間から可測空間を作ることができる。 そうすると前者の定義は「確率空間から位相空間への写像でボレル集合の逆像が可測集合になるような関数」と等価なので、後者の定義に含まれる。 後者の定義の中の可測空間が位相空間由来のものに限定したのが前者の定義であると言える。\n\n\n\n\n\n\n\n\n\nノート\n\n\n\n本当の確率論の言葉で述べると任意のボレル関数(開集合(ボレル集合としても等価)の逆像がボレル集合となる関数) \\(f\\) について \\(f\\circ X\\) は確率変数である。\n\n\n\n\n例 4.1 (コイン投げ) コインを2回独立に投げる場合の確率空間 \\((\\Omega,\\,P)\\) を以下で定義する。\n\n\\(\\Omega = \\{\\mathrm{HH},\\mathrm{HT},\\mathrm{TH},\\mathrm{TT}\\}\\).\n\\(P(A) = \\frac{|A|}{4}\\).\n\n確率変数 \\(X_1\\) と \\(X_2\\) を \\[\\begin{align*}\nX_1(\\mathrm{HH}) &= 1&\nX_1(\\mathrm{HT}) &= 1&\nX_1(\\mathrm{TH}) &= 0&\nX_1(\\mathrm{TT}) &= 0\\\\\nX_2(\\mathrm{HH}) &= 1&\nX_2(\\mathrm{HT}) &= 0&\nX_2(\\mathrm{TH}) &= 1&\nX_2(\\mathrm{TT}) &= 0\n\\end{align*}\\] とすると、\\(k\\in\\{1,2\\}\\) について、\\(X_k\\) は \\(k\\) 回目のコイン投げが表だったときに1、裏だったときに0になる。 また、\\(X=X_1+X_2\\) は表が出た回数を表す確率変数となる。 表が一回以上出る確率は以下のように表せる。 \\[\\begin{align*}\n\\Pr(X\\ge 1) &= P(\\{\\omega\\in\\Omega\\mid X(\\omega)\\ge 1\\}) = P(\\{\\mathrm{HH},\\mathrm{HT},\\mathrm{TH}\\}) = \\frac{3}{4}.\n\\end{align*}\\]",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率変数と確率分布</span>"
    ]
  },
  {
    "objectID": "rv.html#確率分布",
    "href": "rv.html#確率分布",
    "title": "4  確率変数と確率分布",
    "section": "4.2 確率分布",
    "text": "4.2 確率分布\n\n定義 4.2 (累積分布関数) 確率変数 \\(X\\) について累積分布関数 \\(F_X\\colon\\mathbb{R}\\to\\mathbb{R}_{\\ge 0}\\) は以下で定義される。\n\\[\nF_X(x) \\coloneqq \\Pr(X\\le x)\\qquad\\forall x\\in\\mathbb{R}.\n\\]\n\n累積分布関数は定義より単調非減少関数であることが分かる。 累積分布関数は連続とは限らないが右連続であることは以下のように確認できる。\n\\[\\begin{align*}\n\\lim_{n\\to\\infty} \\Pr\\left(X \\le x + \\frac1n\\right) &=\n\\lim_{n\\to\\infty} P\\left(\\left\\{\\omega\\in\\Omega\\mid X(\\omega) \\le x + \\frac1n\\right\\}\\right)\\\\\n&= P\\left(\\bigcap_{n=0}^\\infty \\left\\{\\omega\\in\\Omega\\mid X(\\omega) \\le x + \\frac1n\\right\\}\\right)\\\\\n&= P\\left(\\left\\{\\omega\\in\\Omega\\mid X(\\omega) \\le x\\right\\}\\right)\\\\\n&= \\Pr\\left(X\\le x\\right).\n\\end{align*}\\]\n累積分布関数 \\(F_X\\colon\\mathbb{R}\\to\\mathbb{R}_{\\ge 0}\\) は以下の性質を持つ。\n\n\\(F_X\\) は単調非減少。\n\\(F_X\\) は右連続。\n\\(\\lim_{x\\to\\infty}F_X(x) = 1\\).\n\\(\\lim_{x\\to-\\infty}F_X(x) = 0\\).\n\n確率変数 \\(X\\) の像が高々可算集合のとき、\\(X\\) を離散型確率変数という。 離散型確率変数でない確率変数を連続型確率変数という。\n\\(X\\) が離散型確率変数のとき、\\(A\\) を \\(X\\) の像の部分集合とすると\n\\[\\begin{align*}\n\\Pr(X\\in A) &= P\\left(\\{\\omega\\in\\Omega\\mid X(\\omega)\\in A\\}\\right)\\\\\n&= P\\left(\\bigcup_{x\\in A} \\{\\omega\\in\\Omega\\mid X(\\omega)=x\\}\\right)\\\\\n&= \\sum_{x\\in A} P\\left(\\{\\omega\\in\\Omega\\mid X(\\omega)=x\\}\\right)\\\\\n&= \\sum_{x\\in A} \\Pr\\left(X=x\\right)\n\\end{align*}\\]\nであるので、\n\\[\nf_X(x) \\coloneqq \\Pr(X=x) \\qquad \\forall x\\in\\mathbb{R}\n\\]\nという関数を用いて \\[\n\\Pr(X\\in A) = \\sum_{x\\in A} f_X(x)\n\\] と表せる。 この \\(f_X(x)\\) を \\(X\\) の確率質量関数という。\n\\(X\\) が連続型確率変数のとき、\n\\[\\begin{align*}\n\\Pr(X\\in A) &= \\int_{A} f_X(x) \\mathrm{d}x\\qquad\\forall A\\subseteq\\mathbb{R}\n\\end{align*}\\]\nを満たす \\(f_X\\colon\\mathbb{R}\\to\\mathbb{R}_{\\ge 0}\\) が存在するとき、この \\(f_X(x)\\) を \\(X\\) の確率密度関数という。 しかし、確率密度関数は常に存在するとは限らない。\n\n例 4.2 \\(\\Omega = [0, 1)\\)とし、\\(P\\colon 2^\\Omega\\to\\mathbb{R}_{\\ge 0}\\) を \\(P([a, b)) = b-a\\) を満たす確率測度とする。 確率空間 \\((\\Omega,\\, P)\\) 上の確率変数 \\(X\\colon [0,1)\\to\\mathbb{R}\\) を \\[\nX(\\omega) =\n\\begin{cases}\n2\\omega& \\text{if }\\omega &lt; \\frac12\\\\\n\\frac12& \\text{otherwise.}\n\\end{cases}\n\\] と定義する。\nこの時 \\(X\\) の像は \\([0,1)\\) であるので \\(X\\) は連続型確率変数である。\nまた、\\(\\Pr(X=\\frac12) = P([\\frac12, 1)\\cup\\{\\frac14\\}) = \\frac12\\) である。 よって \\(X\\) の確率密度関数は存在しない。\n\n連続確率変数 \\(X\\) が確率密度関数を持つとき、\n\\[\nF_X(x) = \\int_{-\\infty}^x f_X(z) \\mathrm{d}z\n\\]\nという関係が成り立つ。 よって累積分布関数が微分可能なときは\n\\[\nf_X(x) = \\frac{\\mathrm{d}F_X}{\\mathrm{d}x}\n\\]\nとおいても構わない。確率密度関数はその積分値にのみ意味を持つ。そのため確率密度関数は一意には定まらない。\n例 4.2 の確率変数 \\(X\\) の累積分布関数は以下のようになる。\n\n\nコード\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# xの範囲を定義（-1から2までを細かく分けて計算）\nx = np.linspace(-0.5, 1.5, 1000)\n\n# 区間ごとの関数定義\ny = np.piecewise(\n    x,\n    [x &lt; 0,\n     (0 &lt;= x) & (x &lt; 0.5),\n     (0.5 &lt;= x) & (x &lt; 1),\n     x &gt;= 1],\n    [0,\n     lambda x: x / 2,\n     lambda x: x / 2 + 0.5,\n     1]\n)\n\n# グラフの描画\nplt.figure(figsize=(8, 5))\nplt.plot(x, y, label='$F_X(x)$', color='blue')\nplt.title('CDF of $X$')\nplt.xlabel('$x$')\nplt.ylabel('$F_X(x)$')\nplt.grid(True)\nplt.axhline(0, color='black', linewidth=0.5)\nplt.axvline(0, color='black', linewidth=0.5)\n\n# x = 1/2 の左極限（穴あき）\nx_left = 0.5 - 1e-5  # 少しだけ左\ny_left = x_left / 2\nplt.plot(0.5, y_left, 'o', color='white', markeredgecolor='blue', markersize=8)\n\n# x = 1/2 の値（右からの定義値）\ny_right = 0.5 / 2 + 0.5\nplt.plot(0.5, y_right, 'o', color='blue', markersize=6)\n\nplt.show()\n\n\n\n\n\n\n\n\n図 4.1: \\(X\\)の累積分布関数",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率変数と確率分布</span>"
    ]
  },
  {
    "objectID": "rv.html#離散確率分布の例",
    "href": "rv.html#離散確率分布の例",
    "title": "4  確率変数と確率分布",
    "section": "4.3 離散確率分布の例",
    "text": "4.3 離散確率分布の例\n\n4.3.1 様々な離散確率分布\n\n二項分布 \\(\\mathrm{Binom}(n,p)\\): 表が出る確率が \\(p\\) のコインを \\(n\\) 回独立に投げたとき、表が出る回数の分布 \\[\\Pr(X=k) = \\binom{n}{k} p^k (1-p)^{n-k}.\\]\n幾何分布: 表が出るまでに投げるコインの回数の分布 \\[\\Pr(X=k) = (1-p)^{k-1}p.\\]\n超幾何分布: 袋の中に \\(N\\) 個のボールがあって、そのうち \\(K\\) 個が当たりとし、 \\(n\\) 個引いたときの当たりの個数の分布 \\[\\Pr(X=k) = \\frac{\\binom{K}{k}\\binom{N-K}{n-k}}{\\binom{N}{n}}.\\]\nポアソン分布: \\[\n\\Pr(X=k) = \\frac{\\lambda^k}{k!}\\mathrm{e}^{-\\lambda}.\n\\]\n\n\n\n4.3.2 二項分布\n二項分布の確率質量関数は\n\\[\nf_X(k) = \\binom{n}{k} p^k(1-p)^{n-k}\n\\]\n\nコード\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom scipy.stats import binom\n\n# パラメータの設定\nn = 12       # 試行回数\np = 0.6      # 成功確率\n\n# 取りうる値の範囲\nx = np.arange(0, n+1)\n\n# 二項分布のPMFの計算\npmf = binom.pmf(x, n, p)\ncdf = binom.cdf(x, n, p)\n\n# プロット\nplt.figure(figsize=(4, 2))\nplt.bar(x, pmf, tick_label=x)\nplt.title(f'PMF of binomial distribution with n={n}, p={p}')\nplt.xlabel('$k$')\nplt.ylabel('$\\\\Pr(X=k)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\nplt.figure(figsize=(4, 2))\nplt.step(x, cdf, where='post')\nplt.xticks(x)\nplt.title(f'CDF of binomial distribution with n={n}, p={p}')\nplt.xlabel('$k$')\nplt.ylabel('$\\\\Pr(X\\\\leq k)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n図 4.2: 二項分布の確率質量関数\n\n\n\n\n\n\n\n\n\n\n\n図 4.3: 二項分布の累積分布関数\n\n\n\n\n\n\n\n\n4.3.3 幾何分布\n\\[\nf_X(k) = (1-p)^{k-1}p,\\qquad\\forall k\\ge 1\n\\]\n\nコード\nimport numpy as np\nfrom scipy.stats import geom\nimport matplotlib.pyplot as plt\n\n# パラメータの設定\nn = 12       # 試行回数\np = 0.6      # 成功確率\n\n# 取りうる値の範囲\nk = np.arange(1, n+1)\nkk = np.arange(0, n+1)\n\n# 幾何分布のPMFの計算\npmf = geom.pmf(k, p)\ncdf = geom.cdf(kk, p)\n\n# プロット\nplt.figure(figsize=(4, 2))\nplt.bar(k, pmf, tick_label=k)\nplt.title(f'PMF of geometric distribution with p={p}')\nplt.xlabel('$k$')\nplt.ylabel('$\\\\Pr(X=k)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\nplt.figure(figsize=(4, 2))\nplt.step(kk, cdf, where='post')\nplt.xticks(kk)\nplt.title(f'CDF of geometric distribution with p={p}')\nplt.xlabel('$k$')\nplt.ylabel('$\\\\Pr(X\\\\leq k)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n図 4.4: 幾何分布の確率質量関数\n\n\n\n\n\n\n\n\n\n\n\n図 4.5: 幾何分布の累積分布関数\n\n\n\n\n\n\n\n\n4.3.4 超幾何分布\n\\[\nf_X(k) = \\frac{\\binom{K}{k}\\binom{N-K}{n-k}}{\\binom{N}{n}},\\qquad\\forall k\\in \\{0,\\dotsc,\\min\\{K, n\\}\\}\n\\]\n\nコード\nimport numpy as np\nfrom scipy.stats import hypergeom\nimport matplotlib.pyplot as plt\n\n# パラメータの設定\nN = 40\nn = 16\nK = 12\n\n# 取りうる値の範囲\nk = np.arange(0, K+1)\n\n# 超幾何分布のPMFの計算\npmf = hypergeom.pmf(k, N, K, n)\ncdf = hypergeom.cdf(k, N, K, n)\n\n# プロット\nplt.figure(figsize=(4, 2))\nplt.bar(k, pmf, tick_label=k)\nplt.title(f'PMF of hypergeometric distribution with K={K}, N={N}, n = {n}')\nplt.xlabel('$k$')\nplt.ylabel('$\\\\Pr(X=k)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\nplt.figure(figsize=(4, 2))\nplt.step(k, cdf, where='post')\nplt.xticks(k)\nplt.title(f'CDF of hypergeometric distribution with K={K}, N={N}, n = {n}')\nplt.xlabel('$k$')\nplt.ylabel('$\\\\Pr(X\\\\leq k)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n図 4.6: 超幾何分布の確率質量関数\n\n\n\n\n\n\n\n\n\n\n\n図 4.7: 超幾何分布の累積分布関数\n\n\n\n\n\n\n\n\n4.3.5 ポアソン分布\n\\[\nf_X(k) = \\frac{\\lambda^k}{k!}\\mathrm{e}^{-\\lambda},\\qquad \\forall k\\ge 0\n\\]\n\nコード\nimport numpy as np\nfrom scipy.stats import poisson\nimport matplotlib.pyplot as plt\n\n# パラメータの設定\nlam = 5\n\n# 取りうる値の範囲\nk = np.arange(0, 3*lam)\n\n# ポアソン分布のPMFの計算\npmf = poisson.pmf(k, lam)\ncdf = poisson.cdf(k, lam)\n\n# プロット\nplt.figure(figsize=(4, 2))\nplt.bar(k, pmf, tick_label=k)\nplt.title(f'PMF of Poisson distribution with $\\\\lambda$={lam}')\nplt.xlabel('$k$')\nplt.ylabel('$\\\\Pr(X=k)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\nplt.figure(figsize=(4, 2))\nplt.step(k, cdf, where='post')\nplt.xticks(k)\nplt.title(f'CDF of Poisson distribution with $\\\\lambda$={lam}')\nplt.xlabel('$k$')\nplt.ylabel('$\\\\Pr(X\\\\leq k)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n図 4.8: ポアソン分布の確率質量関数\n\n\n\n\n\n\n\n\n\n\n\n図 4.9: ポアソン分布の累積分布関数\n\n\n\n\n\n\n\n\n4.3.6 確率空間は何か？\n確率変数が従う確率分布のみに注目した議論をする場合、確率空間を陽に考えないことがしばしばある。\n\n二項分布: \\(n\\) 回のコイン投げ、もしくは無限回のコイン投げ。\n幾何分布: 無限回のコイン投げ。\n超幾何分布: \\(K\\) 個の当たりと \\(N-K\\) 個のはずれのボールの \\(\\binom{N}{K}\\) 通りの並び順。\nポアソン分布: ？",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率変数と確率分布</span>"
    ]
  },
  {
    "objectID": "rv.html#連続確率分布の例",
    "href": "rv.html#連続確率分布の例",
    "title": "4  確率変数と確率分布",
    "section": "4.4 連続確率分布の例",
    "text": "4.4 連続確率分布の例\n\n一様分布\n正規分布\n指数分布\n\n\n4.4.1 一様分布\n\\[\\begin{align*}\nf_X(x) &= \\begin{cases}\n\\frac1{b-a}& \\text{if } x\\in[a,b]\\\\\n0&\\text{otherwise}\n\\end{cases},&\nF_X(x) &= \\begin{cases}\n0&\\text{if } x &lt; a\\\\\n\\frac{x-a}{b}&\\text{if } x \\in[a,b]\\\\\n1&\\text{otherwise.}\n\\end{cases}\n\\end{align*}\\]\n\nコード\nimport numpy as np\nfrom scipy.stats import uniform\nimport matplotlib.pyplot as plt\n\n# パラメータの設定\n\n# 取りうる値の範囲\n#x = np.linspace(uniform.ppf(0.01), uniform.ppf(0.99), 100)\nx = np.linspace(-0.1, +1.1, 1000)\n\n# 一様分布のPMFの計算\npdf = uniform.pdf(x)\ncdf = uniform.cdf(x)\n\n# プロット\nplt.figure(figsize=(4, 2))\nplt.plot(x, pdf)\nplt.title(f'PDF of Uniform distribution on $[0,1]$')\nplt.xlabel('$x$')\nplt.ylabel('$f_X(x)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\nplt.figure(figsize=(4, 2))\nplt.plot(x, cdf)\nplt.title(f'CDF of Uniform distribution on $[0,1]$')\nplt.xlabel('$x$')\nplt.ylabel('$F_X(x)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n図 4.10: 一様分布の確率密度関数\n\n\n\n\n\n\n\n\n\n\n\n図 4.11: 一様分布の累積分布関数\n\n\n\n\n\n\n\n\n4.4.2 正規分布 (ガウス分布)\n\\[\\begin{align*}\nf_X(x) &= \\frac1{\\sqrt{2\\pi\\sigma^2}}\\mathrm{e}^{-\\frac{(x-\\mu)^2}{2\\sigma^2}},&\nF_X(x) &= \\int_{-\\infty}^x \\frac1{\\sqrt{2\\pi\\sigma^2}}\\mathrm{e}^{-\\frac{(z-\\mu)^2}{2\\sigma^2}}\\mathrm{d}z\n\\end{align*}\\]\n特に \\(\\mu=0\\), \\(\\sigma=1\\) のとき標準正規分布という。\n\nコード\nimport numpy as np\nfrom scipy.stats import norm\nimport matplotlib.pyplot as plt\n\n# パラメータの設定\n\n# 取りうる値の範囲\nx = np.linspace(norm.ppf(0.001), norm.ppf(0.999), 100)\n\n# 一様分布のPMFの計算\npdf = norm.pdf(x)\ncdf = norm.cdf(x)\n\n# プロット\nplt.figure(figsize=(4, 2))\nplt.plot(x, pdf)\nplt.title(f'PDF of normal distribution with $\\\\mu = 0$ and $\\\\sigma = 1$')\nplt.xlabel('$x$')\nplt.ylabel('$f_X(x)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\nplt.figure(figsize=(4, 2))\nplt.plot(x, cdf)\nplt.title(f'CDF of normal distribution with $\\\\mu = 0$ and $\\\\sigma = 1$')\nplt.xlabel('$x$')\nplt.ylabel('$F_X(x)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n図 4.12: 標準正規分布の確率密度関数\n\n\n\n\n\n\n\n\n\n\n\n図 4.13: 標準正規分布の累積分布関数\n\n\n\n\n\n\n\n\n4.4.3 指数分布\n\\[\\begin{align*}\nf_X(x) &= \\begin{cases}\n0&\\text{if } x &lt; 0\\\\\n\\lambda\\mathrm{e}^{-\\lambda x}&\\text{otherwise}\n\\end{cases},&\nF_X(x) &= \\begin{cases}\n0&\\text{if } x &lt; 0\\\\\n1-\\mathrm{e}^{-\\lambda x}&\\text{otherwise}\n\\end{cases}\n\\end{align*}\\]\n\nコード\nimport numpy as np\nfrom scipy.stats import expon\nimport matplotlib.pyplot as plt\n\n# パラメータの設定\n\n# 取りうる値の範囲\nx = np.linspace(expon.ppf(0.001), expon.ppf(0.999), 100)\n\n# PMFの計算\npdf = expon.pdf(x)\ncdf = expon.cdf(x)\n\n# プロット\nplt.figure(figsize=(4, 2))\nplt.plot(x, pdf)\nplt.title(f'PDF of exponential distribution with $\\\\lambda = 1$')\nplt.xlabel('$x$')\nplt.ylabel('$f_X(x)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\nplt.figure(figsize=(4, 2))\nplt.plot(x, cdf)\nplt.title(f'CDF of exponential distribution with $\\\\lambda = 1$')\nplt.xlabel('$x$')\nplt.ylabel('$F_X(x)$')\nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n図 4.14: 指数分布の確率密度関数\n\n\n\n\n\n\n\n\n\n\n\n図 4.15: 指数分布の累積分布関数",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率変数と確率分布</span>"
    ]
  },
  {
    "objectID": "rv.html#確率密度関数",
    "href": "rv.html#確率密度関数",
    "title": "4  確率変数と確率分布",
    "section": "4.5 確率密度関数",
    "text": "4.5 確率密度関数\n\n補題 4.1 確率変数 \\(X\\) について、 \\[\\begin{align*}\nf_{X+a}(x) &= f_X(x-a)\\qquad\\forall a\\in\\mathbb{R}\\\\\nf_{aX}(x) &= \\frac1{|a|} f_X(x/a)\\qquad\\forall a\\in\\mathbb{R}_{\\ne 0}\n\\end{align*}\\] はそれぞれ \\(X+a\\) と \\(aX\\) の確率密度関数になる。\n\n\n証明. 関数 \\(f_Z\\colon \\mathbb{R}\\to\\mathbb{R}_{\\ge 0}\\) が\n\\[\n\\Pr(Z\\le x) = \\int_{-\\infty}^x f_Z(z)\\mathrm{d} z\n\\]\nを満たすとき、\\(f_Z\\) は確率変数 \\(Z\\) の確率密度関数となる。\n任意の \\(a\\in\\mathbb{R}\\) について、 \\[\\begin{align*}\n\\Pr(X+a\\le x) &= \\Pr(X\\le x-a)\\\\\n&= \\int_{-\\infty}^{x-a} f_{X}(z)\\mathrm{d}z\\\\\n&= \\int_{-\\infty}^{x} f_{X}(z'-a)\\mathrm{d}z'\\qquad (z'=z+a).\n\\end{align*}\\] 任意の \\(a&gt;0\\) について、 \\[\\begin{align*}\n\\Pr(aX\\le x) &= \\Pr(X\\le x/a)\\\\\n&= \\int_{-\\infty}^{x/a} f_{X}(z)\\mathrm{d}z\\\\\n&= \\int_{-\\infty}^{x} \\frac1{a} f_{X}(z'/a)\\mathrm{d}z'\\qquad (z'=az).\n\\end{align*}\\] 任意の \\(a&lt;0\\) について、 \\[\\begin{align*}\n\\Pr(aX\\le x) &= \\Pr(X\\ge x/a)\\\\\n&= \\int_{x/a}^{\\infty} f_{X}(z)\\mathrm{d}z\\\\\n&= \\int_{x}^{-\\infty} \\frac1{a} f_{X}(z'/a)\\mathrm{d}z'\\qquad (z'=az)\\\\\n&= -\\int_{-\\infty}^{x} \\frac1{a} f_{X}(z'/a)\\mathrm{d}z'.\n\\end{align*}\\]\n\n\n補題 4.2 \\(J\\subseteq\\mathbb{R}\\) を有界とは限らない区間とし、\\(g\\colon J\\to\\mathbb{R}\\) を \\(J\\) の内点で微分可能で \\(g'(x)&gt;0\\) と する。 確率変数 \\(X\\) が \\(\\Pr(X\\in J) = 1\\) を満たし確率密度関数を持つとき、 \\[\\begin{align*}\nf_{g(X)}(x) &=\n\\begin{cases}                                                                                                         \\frac1{g'(g^{-1}(x))} f_X(g^{-1}(x))&\\text{if } x\\in\\mathrm{Image}(g)\\\\\n0&\\text{otherwise}\n\\end{cases}\n\\end{align*}\\] は \\(g(X)\\) の確率密度関数になる。\n\n\n証明. \\(\\Pr(g(X)\\in\\mathrm{Image}(g)) = 1\\) なので、\\(x\\notin\\mathrm{Image}(g)\\) について \\(f_{g(X)}(x) = 0\\) とおいてよい。\n任意の \\(x\\in\\mathrm{Image}(g)\\) について \\[\\begin{align*}\n\\Pr(g(X)\\le x) &= \\Pr(X\\le g^{-1}(x))\\\\\n&= \\int_{-\\infty}^{g^{-1}(x)} f_{X}(z)\\mathrm{d}z\\\\\n&= \\int_{\\inf J}^{g^{-1}(x)} f_{X}(z)\\mathrm{d}z\\\\\n&= \\int_{\\inf \\mathrm{Image}(g)}^{x} f_{X}(g^{-1}(z')) \\frac1{g'(g^{-1}(z'))}\\mathrm{d}z'\\qquad (z'=g(z))\\\\\n&= \\int_{-\\infty}^{x} f_{g(X)}(z')\\mathrm{d}z'.\n\\end{align*}\\]",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>確率変数と確率分布</span>"
    ]
  },
  {
    "objectID": "multivariate.html",
    "href": "multivariate.html",
    "title": "5  複数の確率変数",
    "section": "",
    "text": "5.1 事象の条件付き確率と独立性\n二つの事象 \\(A,B\\subseteq\\Omega\\) を考える文脈では \\(P(A\\cap B)\\) を同時確率、\\(P(A),\\,P(B)\\) を周辺確率という。\n事象 \\(A\\) と \\(B\\) が独立であり、\\(P(B)&gt;0\\) であるとき、\\(P(A\\mid B)=P(A)\\) である。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>複数の確率変数</span>"
    ]
  },
  {
    "objectID": "multivariate.html#事象の条件付き確率と独立性",
    "href": "multivariate.html#事象の条件付き確率と独立性",
    "title": "5  複数の確率変数",
    "section": "",
    "text": "定義 5.1 (条件付き確率) 確率空間 \\((\\Omega,\\,P)\\) の事象 \\(A,B\\subseteq\\Omega\\) について \\(P(B)&gt; 0\\) のとき、\\(B\\) における \\(A\\) の条件付き確率 は以下で定義される。 \\[\\begin{align*}\nP(A\\mid B) &\\coloneqq \\frac{P(A\\cap B)}{P(B)}.\n\\end{align*}\\]\n\n\n\n定義 5.2 (事象の独立性) 確率空間 \\((\\Omega,\\,P)\\) の事象 \\(A,B\\subseteq\\Omega\\) について \\[\\begin{align*}\nP(A\\cap B) &= P(A) P(B)\n\\end{align*}\\] を満たすとき、事象 \\(A\\) と \\(B\\) は独立であるという。\n\n\n例 5.1 (二回のコイン投げ) 標本空間を \\(\\Omega = \\{\\mathrm{HH},\\mathrm{HT},\\mathrm{TH},\\mathrm{TT}\\}\\) とし、確率測度を \\(P(A) = \\frac{|A|}4\\quad\\forall A\\subseteq\\Omega\\) とする。 このとき、\\(A=\\{\\mathrm{HH},\\mathrm{HT}\\},\\,B=\\{\\mathrm{HH},\\mathrm{TH}\\}\\) とおくと、 \\[\\begin{align*}\nP(A\\cap B) &= \\frac14,&P(A)&=P(B)=\\frac12\n\\end{align*}\\] より \\(P(A\\cap B) = P(A)P(B)\\) を満たすことが分かる。 よって事象 \\(A,\\,B\\) は独立である。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>複数の確率変数</span>"
    ]
  },
  {
    "objectID": "multivariate.html#確率変数の条件付き確率と独立性",
    "href": "multivariate.html#確率変数の条件付き確率と独立性",
    "title": "5  複数の確率変数",
    "section": "5.2 確率変数の条件付き確率と独立性",
    "text": "5.2 確率変数の条件付き確率と独立性\n事象は確率変数を通じて表すことが多い。そのため確率変数を用いた条件付き確率も定義する。\n\n定義 5.3 (確率変数) 確率空間 \\((\\Omega,\\,P)\\) 上の確率変数 \\(X_1, X_2\\) について同時確率を \\[\\begin{align*}\n\\Pr(X_1\\in A,\\,X_2\\in B) &\\coloneqq P(\\{\\omega\\in\\Omega\\mid X_1(\\omega)\\in A\\}\\cap\\{\\omega\\in\\Omega\\mid X_2(\\omega)\\in B\\}\\})\\quad\\forall A,B\\subseteq\\mathbb{R}\n\\end{align*}\\] と定義する。確率変数が三つ以上の場合も同様に定義する。 また \\(\\Pr(X_2\\in B)&gt;0\\) のとき、条件付き確率は以下で定義する。 \\[\\begin{align*}\n\\Pr(X_1\\in A\\mid X_2\\in B) &\\coloneqq P(\\{\\omega\\in\\Omega\\mid X_1(\\omega)\\in A\\}\\mid\\{\\omega\\in\\Omega\\mid X_2(\\omega)\\in B\\}\\})\\\\\n&=\\frac{\\Pr(X_1\\in A, X_2\\in B)}{\\Pr(X_2\\in B)}\\qquad\\forall A,B\\subseteq\\mathbb{R}.\n\\end{align*}\\] 任意の \\(A,B\\subseteq\\mathbb{R}\\) について、 \\[\\begin{align*}\n\\Pr(X_1\\in A,\\,X_2\\in B)  &= \\Pr(X_1\\in A)\\Pr(X_2\\in B)\n\\end{align*}\\] を満たすとき、確率変数 \\(X_1\\) と \\(X_2\\) は独立であるという。\n\n\n補題 5.1 確率空間 \\((\\Omega,\\,P)\\) 上の確率変数 \\(X_1, X_2\\) が独立であるとする。 このとき任意の関数 \\(f_1,\\,f_2\\colon\\mathbb{R}\\to\\mathbb{R}\\) について、\\(f_1(X_1),\\,f_2(X_2)\\) は独立である。\n\n\n証明. \\[\\begin{align*}\n\\Pr(f_1(X_1)\\in A,\\,f_2(X_2)\\in B) &=\n\\Pr(X_1\\in f_1^{-1}(A),\\,X_2\\in f_2^{-1}(B))\\\\\n&=\\Pr(X_1\\in f_1^{-1}(A))\\Pr(X_2\\in f_2^{-1}(B))\\\\\n&=\\Pr(f_1(X_1)\\in A)\\Pr(f_2(X_2)\\in B).\n\\end{align*}\\]\n\n二つ以上の確率変数の累積分布関数を \\[\\begin{align*}\nF_{X_1,\\dotsc,X_n}(x_1,\\dotsc,x_n) &\\coloneqq\\Pr(X_1\\le x_1,\\dotsc,X_n\\le x_n)\n\\end{align*}\\] と定義する。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>複数の確率変数</span>"
    ]
  },
  {
    "objectID": "multivariate.html#離散型確率変数と確率質量関数",
    "href": "multivariate.html#離散型確率変数と確率質量関数",
    "title": "5  複数の確率変数",
    "section": "5.3 離散型確率変数と確率質量関数",
    "text": "5.3 離散型確率変数と確率質量関数\n\n定義 5.4 確率空間 \\((\\Omega,\\,P)\\) 上の離散型確率変数 \\(X_1\\), \\(X_2\\) について、同時確率質量関数を \\[\\begin{align*}\nf_{X_1,\\,X_2}(x_1,x_2) &\\coloneqq \\Pr(X_1=x_1,\\,X_2=x_2)\\\\\n\\end{align*}\\] と定義する。\n\n同時確率質量関数からそれぞれの確率変数の確率質量関数が得られる。 \\[\\begin{align*}\nf_{X_1}(x_1) &= \\sum_{x_2} f_{X_1,\\, X_2}(x_1, x_2)\\\\\nf_{X_2}(x_2) &= \\sum_{x_1} f_{X_1,\\, X_2}(x_1, x_2)\n\\end{align*}\\] それぞれの確率変数の確率質量関数を周辺質量関数と呼ぶ。 同時確率質量関数から周辺質量関数を計算する操作のことを周辺化という。\n\n定義 5.5 確率空間 \\((\\Omega,\\,P)\\) 上の離散型確率変数 \\(X_1\\), \\(X_2\\) について、条件付き確率質量関数を \\[\\begin{align*}\nf_{X_1\\mid X_2}(x_1\\mid x_2) &\\coloneqq \\Pr(X_1=x_1\\mid X_2=x_2)\n\\end{align*}\\] と定義する。\n\n条件付き確率の定義より \\[\\begin{align*}\nf_{X_1,\\,X_2}(x_1,x_2) &= f_{X_1\\mid X_2}(x_1\\mid x_2) f_{X_2}(x_2)\n\\end{align*}\\] が成り立つ。\n\n補題 5.2 確率空間 \\((\\Omega,\\,P)\\) 上の離散型確率変数 \\(X_1, X_2\\) について、 \\(X_1\\) と \\(X_2\\) が独立 \\(\\iff\\) \\[\\begin{align*}\nf_{X_1,\\,X_2}(x_1,x_2) &= f_{X_1}(x_1) f_{X_2}(x_2)\n&\\forall x_1\\in\\mathrm{Image}(X_1),x_2\\in\\mathrm{Image}(X_2).\n\\end{align*}\\]\n\n\n証明. \\(\\Longrightarrow\\) は自明。 \\(\\Longleftarrow\\) を示す。 \\[\\begin{align*}\n\\Pr(X_1\\in A,\\,X_2\\in B)  &= \\sum_{x_1\\in A}\\sum_{x_2\\in B} \\Pr(X_1=x_1,\\,X_2=x_2)\\\\\n&= \\sum_{x_1\\in A}\\sum_{x_2\\in B} \\Pr(X_1=x_1)\\Pr(X_2=x_2)\\\\\n&= \\Pr(X_1\\in A)\\Pr(X_2\\in B)\n\\end{align*}\\]\n\n\n例 5.2 (二回のコイン投げ) 標本空間を \\(\\Omega = \\{\\mathrm{HH},\\mathrm{HT},\\mathrm{TH},\\mathrm{TT}\\}\\) とし、確率測度を \\(P(A) = \\frac{|A|}4\\quad\\forall A\\subseteq\\Omega\\) とする。 \\[\\begin{align*}\nX_1(\\mathrm{HH})&=X_1(\\mathrm{HT}) = 1,&\nX_1(\\mathrm{TH})&=X_1(\\mathrm{TT}) = 0\\\\\nX_2(\\mathrm{HH})&=X_2(\\mathrm{TH}) = 1,&\nX_2(\\mathrm{HT})&=X_2(\\mathrm{TT}) = 0\n\\end{align*}\\] と定義する。 このとき、 \\[\\begin{align*}\nf_{X_1,\\,X_2}(x_1,\\,x_2) &= \\frac14\\qquad\\forall x_1,x_2\\in\\{0,1\\}\\\\\nf_{X_1}(x_1)=f_{X_2}(x_2)&=\\frac12\\qquad\\forall x_1,x_2\\in\\{0,1\\}\n\\end{align*}\\] より \\(f_{X_1,\\,X_2}(x_1,\\,x_2) = f_{X_1}(x_1)f_{X_2}(x_2)\\) を満たすことが分かる。 よって確率変数 \\(X_1,\\,X_2\\) は独立である。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>複数の確率変数</span>"
    ]
  },
  {
    "objectID": "multivariate.html#連続型確率変数と確率密度関数",
    "href": "multivariate.html#連続型確率変数と確率密度関数",
    "title": "5  複数の確率変数",
    "section": "5.4 連続型確率変数と確率密度関数",
    "text": "5.4 連続型確率変数と確率密度関数\n確率空間 \\((\\Omega,\\,P)\\) 上の連続型確率変数 \\(X_1\\), \\(X_2\\) について、同時確率密度関数を \\[\\begin{align*}\n%\\Pr(\\begin{bmatrix}X_1,\\,X_2\\end{bmatrix}\\in A) &= \\int_A f_{X_1,\\,X_2}(x_1,x_2)\\mathrm{d}x_1\\mathrm{d}x_2\n\\Pr(X_1\\in A,\\,X_2\\in B) &= \\int_A\\left(\\int_B f_{X_1,\\,X_2}(x_1,x_2)\\mathrm{d}x_2\\right)\\mathrm{d}x_1\n\\end{align*}\\] を満たすものと定義する。 \\(X_1\\) と \\(X_2\\) が確率密度関数を持つ場合でも \\(X_1\\) と \\(X_2\\) の同時確率密度関数が存在するとは限らない。 例えば \\(X_1=X_2\\) の場合がその例である。 逆に \\(X_1\\) と \\(X_2\\) が同時確率密度関数を持つとき、それぞれの確率密度関数は \\[\\begin{align*}\nf_{X_1}(x_1) &= \\int_{-\\infty}^\\infty f_{X_1,\\,X_2}(x_1,x_2)\\mathrm{d}x_2\\\\\nf_{X_2}(x_2) &= \\int_{-\\infty}^\\infty f_{X_1,\\,X_2}(x_1,x_2)\\mathrm{d}x_1\n\\end{align*}\\] で得られる。この操作を確率密度関数の周辺化という。 同時確率密度関数を持つ確率変数 \\(X_1\\), \\(X_2\\) が独立であるとき、 \\[\\begin{align*}\nf_{X_1,\\,X_2}(x_1,x_2) &= f_{X_1}(x_1) f_{X_2}(x_2)\n\\end{align*}\\] が成り立つ。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>複数の確率変数</span>"
    ]
  },
  {
    "objectID": "multivariate.html#三つ以上の独立確率変数",
    "href": "multivariate.html#三つ以上の独立確率変数",
    "title": "5  複数の確率変数",
    "section": "5.5 三つ以上の独立確率変数",
    "text": "5.5 三つ以上の独立確率変数\n三つ以上の確率変数についても同時確率質量関数、同時確率密度関数を同様に定義する。 独立性についても同様に定義する。\n\n定義 5.6 確率空間 \\((\\Omega,\\,P)\\) 上の確率変数 \\(X_1, X_2,\\dotsc, X_n\\) が独立 \\(\\defiff\\) \\[\\begin{align*}\n\\Pr(X_1\\in A_1,\\dotsc, X_n\\in A_n) &= \\prod_{k=1}^n \\Pr(X_k\\in A_k)\\qquad\\forall A_1,\\dotsc,A_n\\subseteq\\mathbb{R}.\n\\end{align*}\\]\n\n\n定義 5.7 確率空間 \\((\\Omega,\\,P)\\) 上の確率変数 \\(X_1, X_2,\\dotsc, X_n\\) が互いに独立 \\(\\defiff\\) 任意の \\(1\\le i&lt; j\\le n\\) について、\\(X_i\\) と \\(X_j\\) が独立。\n\n確率変数 \\(X_1,\\dotsc,X_n\\) が独立であるとき、それらは互いに独立であることは以下から分かる。 \\[\\begin{align*}\n\\Pr(X_1\\in A,\\, X_2\\in B) &= \\Pr(X_1\\in A,\\, X_2\\in B,\\, X_3\\in\\mathbb{R},\\dotsc, X_n\\in\\mathbb{R})\\\\\n&= \\Pr(X_1\\in A)\\Pr(X_2\\in B) \\prod_{k=3}^n \\Pr(X_k\\in\\mathbb{R})\\\\\n&= \\Pr(X_1\\in A)\\Pr(X_2\\in B).\n\\end{align*}\\]\n一方で確率変数 \\(X_1,\\dotsc,X_n\\) が互いに独立であっても、それらが独立であるとは限らない。 例えば、離散型確率変数 \\(X_1,\\dotsc,X_n\\) を \\[\\begin{align*}\nf_{X_1,\\dotsc,X_n}(x_1,\\dotsc,x_n)&=\\begin{cases}\n\\frac1{2^{n-1}}&\\text{if } \\sum_{k=1}^n x_k \\text{ is even}\\\\\n0&\\text{otherwise}\n\\end{cases}&\n\\forall x_1,\\dotsc,x_n\\in\\{0,1\\}\n\\end{align*}\\] と定義する。 このとき、確率変数 \\(X_n\\) を周辺化すると \\[\\begin{align*}\nf_{X_1,\\dotsc,X_{n-1}}(x_1,\\dotsc,x_{n-1})&=\nf_{X_1,\\dotsc,X_n}(x_1,\\dotsc,x_{n-1},0)+ f_{X_1,\\dotsc,X_n}(x_1,\\dotsc,x_{n-1},1)\\\\\n&=\\frac1{2^{n-1}}\n\\end{align*}\\] となる。つまり、\\(X_1,\\dotsc,X_{n-1}\\) は \\(\\{0,1\\}^{n-1}\\) 上の一様分布に従う。 この確率分布は \\(X_1,\\dotsc,X_n\\) について対称なので、どの確率変数を周辺化しても一様分布に従う。 一様分布は独立なので、\\(n\\ge 3\\) のとき、どの二つの確率変数も独立である。\n一方で、\\(n\\ge 2\\) のとき、これらの確率変数の周辺確率は一様である。つまり、 \\[\\begin{align*}\nf_{X_k}(0) &= f_{X_k}(1) = \\frac12\\qquad\\forall k=1,2,\\dotsc,n.\n\\end{align*}\\] しかし、 \\[\\begin{align*}\nf_{X_1,\\dotsc,X_n}(x_1,\\dotsc,x_n)&=\\prod_{k=1}^n f_{X_k}(x_k)\\qquad\\forall x_1,\\dotsc,x_n\\in\\{0,1\\}\n\\end{align*}\\] は成り立たないので独立ではない。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>複数の確率変数</span>"
    ]
  },
  {
    "objectID": "multivariate.html#独立な離散型確率変数の和",
    "href": "multivariate.html#独立な離散型確率変数の和",
    "title": "5  複数の確率変数",
    "section": "5.6 独立な離散型確率変数の和",
    "text": "5.6 独立な離散型確率変数の和\n離散型確率変数 \\(X_1\\) と \\(X_2\\) が独立であるとする。 このとき、\\(X_1+X_2\\) の確率質量関数は \\[\\begin{align*}\nf_{X_1+X_2}(x) &= \\sum_z f_{X_1}(z)f_{X_2}(x-z)\n\\end{align*}\\] で与えられる。 これを確率質量関数の畳み込みという。\n\n例 5.3 二項分布の \\(N=1\\) の場合をベルヌーイ分布 \\(\\mathrm{Ber}(p)\\) と呼ぶ。 つまり、\\(X\\sim\\mathrm{Ber}(p)\\defiff\\) \\[\\begin{align*}\n\\Pr(X=0) &= 1-p,& \\Pr(X=1) &= p\n\\end{align*}\\] である。 確率変数 \\(X_1,X_2\\) が独立で \\(\\mathrm{Ber}(p)\\) に従うとする。 このとき、\\(X_1+X_2\\) は \\(\\mathrm{Binom}(2, p)\\) に従う。 \\[\\begin{align*}\n\\Pr(X_1+X_2 = 0) &= \\Pr(X_1=0,\\,X_2=0)\\\\\n&= \\Pr(X_1=0)\\Pr(X_2=0) = (1-p)^2\\\\\n\\Pr(X_1+X_2 = 1) &= \\Pr(X_1=0,\\,X_2=1) + \\Pr(X_1=1,\\,X_2=0)\\\\\n&=  \\Pr(X_1=0)\\Pr(X_2=1) + \\Pr(X_1=1)\\Pr(X_2=0)\\\\\n&= 2p(1-p)\\\\\n\\Pr(X_1+X_2 = 2) &= \\Pr(X_1=1,\\,X_2=1)\\\\\n&= \\Pr(X_1=1)\\Pr(X_2=1) = p^2\n\\end{align*}\\] と計算できる。 よって \\[\\begin{align*}\n\\Pr(X_1+X_2 = k) &= \\binom{2}{k} p^k(1-p)^{2-k}\n\\end{align*}\\] が成り立ち \\(X_1+X_2\\sim\\mathrm{Binom}(2, p)\\) であることが分かる。 一般に、独立確率変数 \\(X_1,\\,X_2\\) について \\(X_1\\sim\\mathrm{Binom}(n, p)\\), \\(X_2\\sim\\mathrm{Binom}(m, p)\\) のとき、\\(X_1+X_2\\sim\\mathrm{Binom}(n+m,p)\\) である。 \\[\\begin{align*}\n\\Pr(X_1+X_2 = k) &= \\sum_{\\ell\\ge 0} \\Pr(X_1 = \\ell) \\Pr(X_2 = k-\\ell)\\\\\n&= \\sum_{\\ell\\ge 0} \\binom{n}{\\ell} p^\\ell(1-p)^{n-\\ell} \\binom{m}{k-\\ell} p^{k-\\ell}(1-p)^{m-k+\\ell}\\\\\n&= \\left(\\sum_{\\ell\\ge 0} \\binom{n}{\\ell} \\binom{m}{k-\\ell}\\right) p^k(1-p)^{n+m-k}\\\\\n&= \\binom{n+m}{k} p^k(1-p)^{n+m-k}.\n\\end{align*}\\]\nよって、\\(X_1,\\dotsc,X_n\\) が独立で \\(\\mathrm{Ber}(p)\\) に従うとき、\\(X_1+\\dotsb+X_n\\) は \\(\\mathrm{Binom}(n, p)\\) に従う。\n\n\n例 5.4 確率変数 \\(X_1\\), \\(X_2\\) が独立で \\(X_1\\sim\\mathrm{Poisson}(\\lambda_1)\\), \\(X_2\\sim\\mathrm{Poisson}(\\lambda_2)\\) とする。 このとき、 \\[\\begin{align*}\nf_{X_1+X_2}(x) &= \\sum_{z= 0}^x f_{X_1}(z) f_{X_2}(x-z)\\\\\n&= \\sum_{z= 0}^x \\frac{\\lambda_1^z}{z!}\\mathrm{e}^{-\\lambda_1}\\frac{\\lambda_2^{x-z}}{(x-z)!}\\mathrm{e}^{-\\lambda_2}\\\\\n&= \\frac1{x!}\\mathrm{e}^{-(\\lambda_1+\\lambda_2)}\\sum_{z=0}^x\\binom{x}{z} \\lambda_1^z\\lambda_2^{x-z}\\\\\n&= \\frac1{x!}\\mathrm{e}^{-(\\lambda_1+\\lambda_2)}(\\lambda_1+\\lambda_2)^x\n\\end{align*}\\] が成り立つ。よって \\(X_1+X_2\\sim\\mathrm{Poisson}(\\lambda_1+\\lambda_2)\\) である。 独立なポアソン分布の和はポアソン分布に従う。\n\nこれらの例のように、確率分布の族(集合)が畳み込みに閉じているとき、確率分布の族は再生性を持つという。 二項分布の場合はパラメータ \\(p\\) を固定したときに再生性を持つ。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>複数の確率変数</span>"
    ]
  },
  {
    "objectID": "multivariate.html#独立な連続型確率変数の和",
    "href": "multivariate.html#独立な連続型確率変数の和",
    "title": "5  複数の確率変数",
    "section": "5.7 独立な連続型確率変数の和",
    "text": "5.7 独立な連続型確率変数の和\n連続確率変数 \\(X_1\\) と \\(X_2\\) が独立で密度関数を持つとき、 \\[\\begin{align*}\n\\Pr(X_1+X_2\\in A) &= \\int\\int_{y+z\\in A} f_{X_1}(y)f_{X_2}(z)\\mathrm{d}y\\mathrm{d}z\\\\\n&= \\int\\int_{x\\in A} f_{X_1}(y)f_{X_2}(x-y)\\mathrm{d}y\\mathrm{d}x \\qquad(x=y+z)\\\\\n&= \\int_{A} \\left(\\int_{-\\infty}^\\infty f_{X_1}(y)f_{X_2}(x-y)\\mathrm{d}y\\right)\\mathrm{d}x \\qquad(x=y+z)\\\\\n\\end{align*}\\] と表せるので、\\(X_1+X_2\\) は確率密度関数を持ち \\[\\begin{align*}\nf_{X_1+X_2}(x) &= \\int_{-\\infty}^\\infty f_{X_1}(z)f_{X_2}(x-z)\\mathrm{d} z\n\\end{align*}\\] とすることができる。 確率変数 \\(X_1,\\,X_2\\) が独立で \\(X_1\\sim N(\\mu_1,\\,\\sigma_1^2)\\), \\(X_2\\sim N(\\mu_2,\\,\\sigma_2^2)\\) とする。 このとき、 \\[\\begin{align*}\nf_{X_1+X_2}(x) &= \\int_{-\\infty}^\\infty f_{X_1}(z)f_{X_2}(x-z)\\mathrm{d} z\\\\\n&= \\int_{-\\infty}^\\infty \\frac1{\\sqrt{2\\pi\\sigma_1^2}} \\mathrm{e}^{-\\frac{(z-\\mu_1)^2}{2\\sigma_1^2}}\\frac1{\\sqrt{2\\pi\\sigma_2^2}} \\mathrm{e}^{-\\frac{(x-z-\\mu_2)^2}{2\\sigma_2^2}}\\mathrm{d} z\\\\\n&= \\frac1{2\\pi\\sqrt{\\sigma_1^2\\sigma_2^2}}\\int_{-\\infty}^\\infty  \\mathrm{e}^{-\\frac{\\sigma_2^2(z-\\mu_1)^2+\\sigma_1^2(x-z-\\mu_2)^2}{2\\sigma_1^2\\sigma_2^2}}\\mathrm{d} z\\\\\n&= \\frac1{2\\pi\\sqrt{\\sigma_1^2\\sigma_2^2}}\\int_{-\\infty}^\\infty  \\mathrm{e}^{-\\frac{(\\sigma_1^2+\\sigma_2^2)\\left(z-\\frac{\\sigma_2^2\\mu_1+\\sigma_1^2(x-\\mu_2)}{\\sigma_1^2+\\sigma_2^2}\\right)^2 + \\sigma_2^2\\mu_1^2 + \\sigma_1^2(x-\\mu_2)^2 - \\frac{(\\sigma_2^2\\mu_1+\\sigma_1^2(x-\\mu_2))^2}{\\sigma_1^2+\\sigma_2^2}}{2\\sigma_1^2\\sigma_2^2}}\\mathrm{d} z\\\\\n&= \\frac1{\\sqrt{2\\pi(\\sigma_1^2+\\sigma_2^2)}}\\mathrm{e}^{-\\frac{\\sigma_2^2\\mu_1^2 + \\sigma_1^2(x-\\mu_2)^2 - \\frac{(\\sigma_2^2\\mu_1+\\sigma_1^2(x-\\mu_2))^2}{\\sigma_1^2+\\sigma_2^2}}{2\\sigma_1^2\\sigma_2^2}}\\\\\n&= \\frac1{\\sqrt{2\\pi(\\sigma_1^2+\\sigma_2^2)}}\\mathrm{e}^{-\\frac{(x-(\\mu_1+\\mu_2))^2}{2(\\sigma_1^2+\\sigma_2^2)}}\\\\\n\\end{align*}\\] が成り立つので \\(X_1+X_2\\sim N(\\mu_1+\\mu_2,\\,\\sigma_1^2+\\sigma_2^2)\\) であることが分かる。 よって正規分布は再生性を持つ。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>複数の確率変数</span>"
    ]
  },
  {
    "objectID": "moments.html",
    "href": "moments.html",
    "title": "6  期待値、分散、モーメント",
    "section": "",
    "text": "6.1 期待値\n連続型確率変数の期待値に関する様々な証明はルベーグ積分の知識を必要とするので本書では扱わない。 以下、証明はすべて離散確率変数の場合に限って与える。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>期待値、分散、モーメント</span>"
    ]
  },
  {
    "objectID": "moments.html#期待値",
    "href": "moments.html#期待値",
    "title": "6  期待値、分散、モーメント",
    "section": "",
    "text": "定義 6.1 (期待値) 離散型確率変数 \\(X\\) の期待値は\n\\[\\begin{align*}\n\\expt{X}\n% &= \\sum_{\\omega \\in \\Omega} X(\\omega) P(\\{\\omega\\})\\\\\n%&= \\sum_{x\\in \\mathrm{Image}(X)} x P(\\{\\omega\\mid X(\\omega)=x\\})\\\\\n&\\coloneqq \\sum_{x\\in \\mathrm{Image}(X)} x \\Pr(X=x)\\\\\n&= \\sum_{x\\in \\mathrm{Image}(X)} x f_X(x)\n\\end{align*}\\]\nと定義される。ここで、右辺の和が絶対収束しない場合は(適当な順番で和を取って収束したとしても)期待値は定義されない。\n連続型確率変数 \\(X\\) が確率密度関数 \\(f_X\\) を持つとき、その期待値は\n\\[\n\\expt{X}\\coloneqq \\int_{-\\infty}^\\infty x f_X(x) \\mathrm{d}x\n\\]\nと定義される。ただし、広義積分で上記の積分が存在する場合でも \\[\n\\int_{-\\infty}^\\infty |x| f_X(x) \\mathrm{d}x\n\\] が存在しない場合は期待値は定義されない。\n\n\n\n補題 6.1 確率変数 \\(X,\\,Y\\) について \\[\\begin{align*}\n\\expt{X+Y}&=\\expt{X}+\\expt{Y}\n\\end{align*}\\] である。 また、\\(X\\) と \\(Y\\) が独立のとき、 \\[\\begin{align*}\n\\expt{XY}&=\\expt{X}\\,\\expt{Y}\n\\end{align*}\\] である。\n\n\n証明. \\[\\begin{align*}\n\\expt{X+Y} &= \\sum_{z} z f_{X+Y}(z)\\\\\n&= \\sum_{z} z \\sum_x f_{X,\\,Y}(x, z-x)\\\\\n&= \\sum_{x,\\,y} (x+y) f_{X,\\,Y}(x, y)\\qquad (y=z-x)\\\\\n&= \\sum_{x,\\,y} xf_{X,\\,Y}(x,y) + \\sum_{x,\\,y} yf_{X,\\,Y}(x,y)\\\\\n&= \\sum_{x} xf_{X}(x) + \\sum_{y} yf_{Y}(y)\\\\\n&= \\expt{X} + \\expt{Y}.\n\\end{align*}\\] \\(X\\) と \\(Y\\) が独立のとき、 \\[\\begin{align*}\n\\expt{XY} &= \\sum_{z} z f_{XY}(z)\\\\\n&= \\sum_{z} z \\sum_{x\\ne 0}f_{X,\\,Y}(x,z/x)\\\\\n&= \\sum_{z} z \\sum_{x\\ne 0}f_{X}(x)f_Y(z/x)\\\\\n&= \\sum_{x\\ne 0,\\, y} xy f_{X}(x)f_Y(y)\\qquad(y=z/x)\\\\\n&= \\sum_{x,\\, y} xy f_{X}(x)f_Y(y)\\\\\n&= \\left(\\sum_{x} xf_{X}(x)\\right)\\left(\\sum_y yf_Y(y)\\right)\\\\\n&= \\expt{X}\\,\\expt{Y}\n\\end{align*}\\]\n\n\n補題 6.2 (Law of the unconscious statistician (LOTUS)) 任意の関数 \\(g\\colon\\mathbb{R}\\to\\mathbb{R}\\) について、\n\n\\(X\\) が離散型確率変数のとき、 \\[\\begin{align*}\n\\expt{g(X)} &= \\sum_{x} g(x) f_X(x).\n\\end{align*}\\]\n\\(X\\) が連続型確率変数で確率密度関数を持つとき、 \\[\\begin{align*}\n\\expt{g(X)} &= \\int_{-\\infty}^\\infty g(x) f_X(x) \\mathrm{d}x.\n\\end{align*}\\]\n\n\n\n証明. \\(X\\) を離散型確率変数とする。 \\[\\begin{align*}\n\\expt{g(X)}\n%&= \\sum_{x} x f_{g(X)}(x)\\\\\n&= \\sum_{x} x \\Pr(g(X) = x)\\\\\n&= \\sum_{x} x P(\\{\\omega\\in\\Omega\\mid g(X(\\omega)) = x\\})\\\\\n&= \\sum_{x} x P\\left(\\bigcup_{y\\in\\mathrm{Image}(X)\\colon\\, g(y) = x}\\{\\omega\\in\\Omega\\mid X(\\omega) = y\\}\\right)\\\\\n&= \\sum_{x}\\sum_{y\\in\\mathrm{Image}(X)\\colon\\, g(y) = x} x P\\left(\\{\\omega\\in\\Omega\\mid X(\\omega) = y\\}\\right)\\\\\n&= \\sum_{y\\in\\mathrm{Image}(X)} g(y) f_X(y).\n\\end{align*}\\] \n\n\n命題 6.1 (期待値の性質) 任意の確率変数 \\(X\\) と \\(a\\in\\mathbb{R}\\) について \\[\\begin{align*}\n\\expt{X+a} &= \\expt{X}+a\\\\\n\\expt{aX} &= a\\expt{X}.\n\\end{align*}\\]\n\n\n定理 6.1 (マルコフの不等式) 非負確率変数 \\(X\\) と \\(a&gt;0\\) について \\[\n\\Pr(X\\ge a)\\le\\frac{\\expt{X}}{a}.\n\\]\n\n\n証明. \\[\\begin{align*}\n\\expt{X} &= \\sum_{x\\in \\mathrm{Image}(X)} f_X(x) x\\\\\n&= \\sum_{\\mathrm{Image}(X)\\colon\\, x\\ge a} f_X(x) x + \\sum_{\\mathrm{Image}(X)\\colon\\, x &lt; a} f_X(x) x\\\\\n&\\ge \\sum_{\\mathrm{Image}(X)\\colon\\, x\\ge a} f_X(x) x\\qquad\\qquad (\\Pr(X\\ge 0)=1)\\\\\n&\\ge \\sum_{\\mathrm{Image}(X)\\colon\\, x\\ge a} f_X(x) a\\\\\n&= \\Pr(X\\ge a) a.\n\\end{align*}\\]",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>期待値、分散、モーメント</span>"
    ]
  },
  {
    "objectID": "moments.html#分散",
    "href": "moments.html#分散",
    "title": "6  期待値、分散、モーメント",
    "section": "6.2 分散",
    "text": "6.2 分散\n\n定義 6.2 (分散) 確率変数 \\(X\\) が期待値を持つとき、その分散を\n\\[\n\\var{X}\\coloneqq  \\expt{(X-\\expt{X})^2}\n\\]\nと定義する。 また、分散の平方根を標準偏差という。\n\n確率変数 \\(X\\) が分散を持つとき、\n\\[\\begin{align*}\n\\var{X} &= \\expt{(X-\\expt{X})^2}\\\\\n&= \\expt{X^2-2X\\expt{X}+\\expt{X}^2}\\\\\n&= \\expt{X^2}-2\\expt{X}\\expt{X}+\\expt{X}^2\\\\\n&= \\expt{X^2}-\\expt{X}^2\n\\end{align*}\\]\nである。 分散は定義より非負の値を取る。\n\n命題 6.2 (分散の性質) 任意の確率変数 \\(X\\) と \\(a\\in\\mathbb{R}\\) について \\[\\begin{align*}\n\\var{X+a} &= \\var{X}\\\\\n\\var{aX} &= a^2\\var{X}.\n\\end{align*}\\]\n\n分散は直感的には期待値からのはずれ具合を表す値である。\n\n定理 6.2 (チェビシェフの不等式) 非負確率変数 \\(X\\) と \\(a&gt;0\\) について \\[\n\\Pr(|X-\\expt{X}|\\ge a)\\le\\frac{\\var{X}}{a^2}.\n\\]\n\n\n証明. \\[\\begin{align*}\n\\Pr(|X-\\expt{X}|\\ge a)&= \\Pr((X-\\expt{X})^2\\ge a^2)\\\\\n&\\le\n\\frac{\\expt{(X-\\expt{X})^2}}{a^2} = \\frac{\\var{X}}{a^2}.\n\\end{align*}\\]\n\n\n補題 6.3 (互いに独立な確率変数の和) 確率変数 \\(X_1,\\,X_2,\\dotsc,X_n\\) が互いに独立のとき\n\\[\\begin{align*}\n\\var{X_1+\\dotsb+X_n} &= \\var{X_1} +\\dotsb + \\var{X_n}.\n\\end{align*}\\]\n\n\n証明. \\[\\begin{align*}\n\\var{X_1+\\dotsb+X_n} &= \\expt{\\left((X_1+\\dotsb+X_n) - \\expt{X_1+\\dotsb+X_n}\\right)^2}\\\\\n&= \\expt{\\left((X_1- \\expt{X_1}) + \\dotsb + (X_n-\\expt{X_n})\\right)^2}\\\\\n&= \\expt{\\sum_i (X_i- \\expt{X_i})^2  + 2\\sum_{i &lt; j}\\left(X_i-\\expt{X_i}\\right)\\left(X_j-\\expt{X_j}\\right)}\\\\\n&= \\sum_i \\expt{(X_i- \\expt{X_i})^2} +  2\\sum_{i &lt; j}\\expt{\\left(X_i-\\expt{X_i}\\right)\\left(X_j-\\expt{X_j}\\right)}\\\\\n&= \\sum_i \\expt{(X_i- \\expt{X_i})^2} +  2\\sum_{i &lt; j}\\expt{X_i-\\expt{X_i}}\\expt{X_j-\\expt{X_j}}\\\\\n&= \\sum_i \\expt{(X_i- \\expt{X_i})^2}\n=\\sum_i \\var{X_i}.\n\\end{align*}\\]\n\n\n例 6.1 互いに独立な確率変数 \\(X_1,\\dotsc,X_n\\) のそれぞれが確率変数 \\(X\\) と同分布であるとし、 \\[\\begin{align*}\nY&\\coloneqq \\frac1{n} (X_1+\\dotsb+X_n)\n\\end{align*}\\] と定義する。 このとき、 \\[\\begin{align*}\n\\expt{Y} &= \\expt{X}\\\\\n\\var{Y} &= \\frac1{n}\\var{X}\n\\end{align*}\\] である。互いに独立な確率変数の平均を取ると期待値は変わらず、分散は小さくなる。\n\n\n例 6.2 独立確率変数 \\(X_1,\\dotsc,X_n\\sim\\mathrm{Ber}(1/2)\\) について \\[\\begin{align*}\nY_S &\\coloneqq \\sum_{i\\in S} X_i \\mod 2\\qquad\\forall S\\subseteq\\{1,2,\\dotsc,n\\}\n\\end{align*}\\] と定義すると、これらは互いに独立である。 また、\\(S\\ne\\varnothing\\) について \\(Y_S\\sim\\mathrm{Ber}(1/2)\\) である。 任意の関数 \\(g\\colon\\,\\{0,1\\}\\to\\mathbb{R}\\) について、 \\[\\begin{align*}\nY&\\coloneqq \\frac1{2^n-1} \\sum_{S\\subseteq\\{1,\\dotsc,n\\}\\colon\\, S\\ne\\varnothing} g(Y_S)\n\\end{align*}\\] と定義すると、\\(X\\sim\\mathrm{Ber}(1/2)\\) について、 \\[\\begin{align*}\n\\expt{Y} &= \\expt{g(X)}\\\\\n\\var{Y} &= \\frac1{2^n-1}\\var{g(X)}.\n\\end{align*}\\]",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>期待値、分散、モーメント</span>"
    ]
  },
  {
    "objectID": "moments.html#共分散",
    "href": "moments.html#共分散",
    "title": "6  期待値、分散、モーメント",
    "section": "6.3 共分散",
    "text": "6.3 共分散\n\n定義 6.3 (共分散) 確率変数 \\(X,Y\\) が期待値を持つとき、その共分散を\n\\[\\begin{align*}\n\\cov{X}{Y} &\\coloneqq \\expt{(X-\\expt{X})(Y-\\expt{Y})}\\\\\n&= \\expt{XY}-\\expt{X}\\,\\expt{Y}\n\\end{align*}\\]\nと定義する。 共分散がゼロである確率変数のペアを無相関であるという。\n\n定義より、\\(\\cov{X}{X}=\\var{X}\\) であることが分かる。\n\n命題 6.3 独立確率変数 \\(X,Y\\) は無相関である。\n\n逆に無相関であっても独立とは限らない。\n\n例 6.3 確率変数 \\(X\\) を \\[\\begin{align*}\nf_X(0)= f_X(+1)= f_X(-1)= \\frac13\n\\end{align*}\\] を満たすものとし、\\(Y=X^2\\) とする。 このとき、 \\[\\begin{align*}\n\\cov{X}{Y} &= \\expt{XY} - \\expt{X}\\expt{Y}\\\\\n&= \\expt{X^3} - \\expt{X}\\expt{X^2}\\\\\n&= \\expt{X} - \\expt{X}\\expt{X^2}\\\\\n&= \\expt{X}(1-\\expt{X^2})\\\\\n&= 0\n\\end{align*}\\] なので、\\(X\\) と \\(Y\\) は無相関である。 一方で \\[\\begin{align*}\nf_{Y}(0) &= \\frac13&\nf_{Y}(1) &= \\frac23\\\\\nf_{X,\\,Y}(0, 0) &= \\frac13&\nf_{X,\\,Y}(1, 1) &= \\frac13&\nf_{X,\\,Y}(-1, 1) &= \\frac13&\n\\end{align*}\\] なので \\(X\\) と \\(Y\\) は独立ではない。\n\n共分散は正の値も負の値も取り得る。 大雑把に言うと、\n\n\\(X\\) と \\(Y\\) の共分散が正 \\(\\iff\\) \\(X\\) が大きいとき \\(Y\\) も大きい\n\\(X\\) と \\(Y\\) の共分散が負 \\(\\iff\\) \\(X\\) が大きいとき \\(Y\\) は小さい\n\nという意味になる。\n\n補題 6.4 任意の確率変数 \\(X_1,\\dotsc,X_n\\) について \\[\\begin{align*}\n\\var{\\sum_i X_i} &= \\sum_i \\var{X_i} + 2\\sum_{i &lt; j} \\cov{X_i}{X_j}.\n\\end{align*}\\]\n\n\n証明. 補題 6.3 の証明参照。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>期待値、分散、モーメント</span>"
    ]
  },
  {
    "objectID": "moments.html#モーメントとモーメント母関数",
    "href": "moments.html#モーメントとモーメント母関数",
    "title": "6  期待値、分散、モーメント",
    "section": "6.4 モーメントとモーメント母関数",
    "text": "6.4 モーメントとモーメント母関数\n\n定義 6.4 (モーメント) 確率変数 \\(X\\) と正の整数 \\(n\\ge 1\\) について、\n\\[\n\\mu_n(X)\\coloneqq \\expt{X^n}\n\\]\nを \\(X\\) の \\(n\\) 次モーメントという。\n\n\n定義 6.5 (モーメント母関数(積率母関数)) 確率変数 \\(X\\) について、\n\\[\nM_X(t) \\coloneqq \\expt{\\mathrm{e}^{tX}}\\qquad t\\in\\mathbb{R}\n\\]\nを \\(X\\) のモーメント母関数という。 すべての \\(t\\in\\mathbb{R}\\) で \\(M_X(t)\\) が存在しない場合もある。 また、\n\\[\nK_X(t) \\coloneqq \\log M_X(t)\n\\] を \\(X\\) のキュムラント母関数という。\n\n\n今後は以下の補題を認めることにする。証明にはルベーグ積分の知識が必要である。\n\n定理 6.3 確率変数 \\(X\\) について、ある \\(\\epsilon &gt;0\\) が存在し、モーメント母関数 \\(M_X(t)\\) が \\(t\\in(-\\epsilon,\\epsilon)\\) で存在するとき、\n\\[\\begin{align*}\nM_X(t) &=\\sum_{n\\ge 0}\\frac{\\expt{X^n}}{n!}t^n\\qquad\\forall t\\in(-\\epsilon,\\epsilon)\\\\\n\\mu_n(X) &= \\left.\\frac{\\mathrm{d}^n M_X(t)}{\\mathrm{d} t^n}\\right|_{t=0}.\n\\end{align*}\\]\n\n\n証明. 前半の証明を与える。 離散型確率変数 \\(X\\) について、 \\[\\begin{align*}\nM_X(t) &= \\expt{\\mathrm{e}^{tX}}\\\\\n&= \\sum_x \\mathrm{e}^{tx} f_X(x)\\\\\n&= \\sum_x \\left(\\sum_{n\\ge0}\\frac{(tx)^n}{n!}\\right) f_X(x)\n\\end{align*}\\] である。 ここで、任意の \\(t\\in(-\\epsilon,\\epsilon)\\) について \\[\\begin{align*}\n&\\sum_x \\sum_{n\\ge0}\\left|\\frac{(tx)^n}{n!} f_X(x)\\right|\\\\\n&= \\sum_x \\sum_{n\\ge0}\\frac{|tx|^n}{n!} f_X(x)\\\\\n&= \\sum_x \\mathrm{e}^{|tx|} f_X(x)\\\\\n&\\le \\sum_x (\\mathrm{e}^{tx}+\\mathrm{e}^{-tx}) f_X(x)\\\\\n&= \\expt{\\mathrm{e}^{tX}} + \\expt{\\mathrm{e}^{-tX}}\\\\\n&= M_X(t) + M_X(-t) &lt; \\infty\n\\end{align*}\\] よって、無限和 \\[\\begin{align*}\n\\sum_x \\sum_{n\\ge0}\\frac{(tx)^n}{n!} f_X(x)\n\\end{align*}\\] は任意の \\(t\\in(-\\epsilon,\\epsilon)\\) について絶対収束する。 そのため、和の順序を変えても収束値は変化しない。 よって、 \\[\\begin{align*}\nM_X(t) &= \\expt{\\mathrm{e}^{tX}}\\\\\n&= \\sum_x \\left(\\sum_{n\\ge0}\\frac{(tx)^n}{n!}\\right) f_X(x)\\\\\n&= \\sum_{n\\ge 0} \\sum_{x}\\frac{(tx)^n}{n!}f_X(x)\\\\\n&= \\sum_{n\\ge 0} \\frac{\\sum_xx^n f_X(x)}{n!}t^n\\\\\n&= \\sum_{n\\ge 0} \\frac{\\expt{X^n}}{n!}t^n\\qquad\\forall t\\in(-\\epsilon,\\epsilon).\n\\end{align*}\\] \n\n\n系 6.1 確率変数 \\(X\\) について、ある \\(\\epsilon &gt;0\\) が存在し、モーメント母関数 \\(M_X(t)\\) が \\(t\\in(-\\epsilon,\\epsilon)\\) で存在するとき、\n\\[\\begin{align*}\n\\left.\\frac{\\mathrm{d} K_X(t)}{\\mathrm{d} t}\\right|_{t=0} &= \\expt{X}\\\\\n\\left.\\frac{\\mathrm{d}^2 K_X(t)}{\\mathrm{d} t^2}\\right|_{t=0} &=  \\var{X}.\n\\end{align*}\\]\n\n\n証明. \\[\\begin{align*}\n\\left.\\frac{\\mathrm{d} K_X(t)}{\\mathrm{d} t}\\right|_{t=0} &= \\left.\\frac{M'_X(t)}{M_X(t)}\\right|_{t=0}=\\expt{X}\\\\\n\\left.\\frac{\\mathrm{d}^2 K_X(t)}{\\mathrm{d} t^2}\\right|_{t=0} &= \\left.\\frac{M''_X(t)M_X(t) - M'_X(t)^2}{M_X(t)^2}\\right|_{t=0} = M''_X(0) - M'_X(0)^2 = \\var{X}.\n\\end{align*}\\]\n\nまた、重要度は低くなるが、\n\\[\\begin{align*}\n\\left.\\frac{\\mathrm{d}^3 K_X(t)}{\\mathrm{d} t^3}\\right|_{t=0} &= \\expt{(X - \\expt{X})^3}\\\\\n\\left.\\frac{\\mathrm{d}^4 K_X(t)}{\\mathrm{d} t^4}\\right|_{t=0} &= \\expt{(X - \\expt{X})^4} - 3\\var{X}^2\n\\end{align*}\\]\nが成り立つ。 一般に \\[\\begin{align*}\n\\kappa_n(X) &\\coloneqq \\left.\\frac{\\mathrm{d}^n K_X(t)}{\\mathrm{d} t^n}\\right|_{t=0}\n\\end{align*}\\] を \\(X\\) の \\(n\\) 次キュムラント と呼ぶ。\n\n定理 6.4 確率変数 \\(X\\) と \\(Y\\) のモーメント母関数が0を含む開区間 \\((-\\epsilon,\\,\\epsilon)\\) で存在し、それらが等しいとき、\\(X\\) の分布と \\(Y\\) の分布は等しい。\n\n\n証明. \\(\\mathrm{Image}(X)\\) と \\(\\mathrm{Image}(Y)\\) が有限の場合に限って証明を与える (この場合はモーメント母関数は \\(\\mathbb{R}\\) 全体で存在するのだが)。 \\[\\begin{align*}\n\\{x_0,\\dotsc,x_{N-1}\\} &\\coloneqq \\mathrm{Image}(X) \\cup \\mathrm{Image}(Y)\n\\end{align*}\\] とする。 \\[\\begin{align*}\nM_X(t) &= \\sum_{k=0}^{N-1} f_X(x_k) \\mathrm{e}^{tx_k}\\\\\nM_Y(t) &= \\sum_{k=0}^{N-1} f_Y(x_k) \\mathrm{e}^{tx_k}\n\\end{align*}\\] なので、 \\[\\begin{align*}\n0 = M_X(t) - M_Y(t) &= \\sum_{k=0}^{N-1} (f_X(x_k)-f_Y(x_k)) \\mathrm{e}^{tx_k}\\qquad\\forall t\\in(-\\epsilon,\\epsilon)\n\\end{align*}\\] 各 \\(k\\in\\{0,1,\\dotsc,N-1\\}\\) について、\\(t_k\\coloneqq \\epsilon\\frac{k}{N}\\) とおくと、 \\[\\begin{align}\n\\sum_{k=0}^{N-1} (f_X(x_k)-f_Y(x_k)) \\mathrm{e}^{t_\\ell x_k}&=0\\qquad\\forall \\ell\\in\\{0,1,\\dotsc,N-1\\}\n\\end{align}\\] である。 ここで、\\(N\\times N\\) 実行列 \\(V\\) を \\[\\begin{align*}\nV_{\\ell k} &= \\mathrm{e}^{t_\\ell x_k}\n= \\mathrm{e}^{\\frac{\\epsilon x_k}{N} \\ell}\\qquad\\forall k,\\ell\\in\\{0,1,\\dotsc,N-1\\}\n\\end{align*}\\] とおく。 この行列 \\(V\\) は Vandermonde行列の転置であり正則なので、 \\[\\begin{align*}\n&\\sum_{k=0}^{N-1} V_{\\ell k} g_k=0\\qquad\\forall \\ell\\in\\{0,1,\\dotsc,N-1\\}\\\\\n\\implies& g_k = 0 \\qquad\\forall k\\in\\{0,1,\\dotsc,N-1\\}\n\\end{align*}\\] よって、 \\[\\begin{align*}\nf_X(x_k) &= f_Y(x_k) \\qquad\\forall k\\in\\{0,1,\\dotsc,N-1\\}\n\\end{align*}\\] である。\n\n定理 6.4 より、モーメント母関数には確率変数の分布のすべての情報が含まれていると言える。 ただし、モーメント母関数は原点まわりで存在しないこともあるので、分布の情報をすべて含む関数としては特性関数 \\[\\begin{align*}\n\\varphi_X(t) &\\coloneqq \\expt{\\mathrm{e}^{itX}}\\qquad\\forall t\\in\\mathbb{R}\n\\end{align*}\\] の方が優秀である。 特性関数は常に存在する。 一方でモーメント母関数は確率の集中を示す文脈では中心的な役割を果たす。",
    "crumbs": [
      "確率論",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>期待値、分散、モーメント</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "参考文献",
    "section": "",
    "text": "Knuth, Donald E. 1984. “Literate Programming.” Comput.\nJ. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "参考文献"
    ]
  }
]