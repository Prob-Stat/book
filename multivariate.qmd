# 条件付き確率

## 事象の条件付き確率と独立性

::: {#def-cond}
### 条件付き確率

確率空間 $(\Omega,\,P)$ の事象 $A,B\subseteq\Omega$ について
$P(B)> 0$ のとき、**$B$ における $A$ の条件付き確率** は以下で定義される。
\begin{align*}
P(A\mid B) &\coloneqq \frac{P(A\cap B)}{P(B)}
\end{align*}
:::

二つの事象 $A,B\subseteq\Omega$ を考える文脈では $P(A\cap B)$ を**同時確率**、$P(A),\,P(B)$ を**周辺確率**という。

::: {#def-ind}
### 事象の独立性

確率空間 $(\Omega,\,P)$ の事象 $A,B\subseteq\Omega$ について
\begin{align*}
P(A\cap B) &= P(A) P(B)
\end{align*}
を満たすとき、**事象 $A$ と $B$ は独立である**という。
:::

::: {#exm-ind}
### 二回のコイン投げ
標本空間を $\Omega = \{\mathrm{HH},\mathrm{HT},\mathrm{TH},\mathrm{TT}\}$ とし、確率測度を $P(A) = \frac{|A|}4\quad\forall A\subseteq\Omega$ とする。
このとき、$A=\{\mathrm{HH},\mathrm{HT}\},\,B=\{\mathrm{HH},\mathrm{TH}\}$ とおくと、
\begin{align*}
P(A\cap B) &= \frac14,&P(A)&=P(B)=\frac12
\end{align*}
より $P(A\cap B) = P(A)P(B)$ を満たすことが分かる。
よって事象 $A,\,B$ は独立である。
:::

事象 $A$ と $B$ が独立であり、$P(B)>0$ であるとき、$P(A\mid B)=P(A)$ である。

## 確率変数の条件付き確率と独立性
事象は確率変数を通じて表わすことが多い。そのため

::: {#def-cond-rv}
### 確率変数
確率空間 $(\Omega,\,P)$ 上の確率変数 $X_1, X_2$ について同時確率を
\begin{align*}
\Pr(X_1\in A,\,X_2\in B) &\coloneqq P(\{\omega\in\Omega\mid X_1(\omega)\in A\}\cap\{\omega\in\Omega\mid X_2(\omega)\in B\}\})\quad\forall A,B\subseteq\mathbb{R}
\end{align*}
と定義する。確率変数が三つ以上の場合も同様に定義する。
また $\Pr(X_2\in B)>0$ のとき、条件付き確率は以下で定義する。
\begin{align*}
\Pr(X_1\in A\mid X_2\in B) &\coloneqq P(\{\omega\in\Omega\mid X_1(\omega)\in A\}\mid\{\omega\in\Omega\mid X_2(\omega)\in B\}\})\\
&=\frac{\Pr(X_1\in A, X_2\in B)}{\Pr(X_2\in B)}\qquad\forall A,B\subseteq\mathbb{R}.
\end{align*}
任意の $A,B\subseteq\mathbb{R}$ について、
\begin{align*}
\Pr(X_1\in A,\,X_2\in B)  &= \Pr(X_1\in A)\Pr(X_2\in B)
\end{align*}
を満たすとき、**確率変数 $X_1$ と $X_2$ は独立である**という。
:::

二つ以上の確率変数の累積分布関数を
\begin{align*}
F_{X_1,\dotsc,X_n}(x_1,\dotsc,x_n) &\coloneqq\Pr(X_1\le x_1,\dotsc,X_n\le x_n)
\end{align*}
と定義する。

## 離散型確率変数と確率質量関数

::: {#def-cond-mass}
確率空間 $(\Omega,\,P)$ 上の離散型確率変数 $X_1$, $X_2$ について、**同時確率質量関数**を
\begin{align*}
f_{X_1,\,X_2}(x_1,x_2) &\coloneqq \Pr(X_1=x_1,\,X_2=x_2)\\
f_{X_1\mid X_2}(x_1\mid x_2) &\coloneqq \Pr(X_1=x_1\mid X_2=x_2)
\end{align*}
と定義する。
:::

\begin{align*}
f_{X_1,\,X_2}(x_1,x_2) &= f_{X_1\mid X_2}(x_1\mid x_2) f_{X_2}(x_2)
\end{align*}
が成り立つ。
また、同時確率質量関数からそれぞれの確率変数の確率質量関数が得られる。
\begin{align*}
f_{X_1}(x_1) &= \sum_{x_2} f_{X_1, X_2}(x_1, x_2)\\
f_{X_2}(x_2) &= \sum_{x_1} f_{X_1, X_2}(x_1, x_2)
\end{align*}
それぞれの確率変数の確率質量関数を**周辺質量関数**と呼ぶ。
同時確率質量関数から周辺質量関数を計算する操作のことを**周辺化**という。

::: {#lem-cond}
確率空間 $(\Omega,\,P)$ 上の**離散型**確率変数 $X_1, X_2$ について、
$X_1$ と $X_2$ が独立 $\iff$
\begin{align*}
f_{X_1,\,X_2}(x_1,x_2) &= f_{X_1}(x_1) f_{X_2}(x_2)
&\forall x_1\in\mathrm{Image}(X_1),x_2\in\mathrm{Image}(X_2).
\end{align*}
:::
::: {.proof}
$\Longrightarrow$ は自明。
$\Longleftarrow$ を示す。
\begin{align*}
\Pr(X_1\in A,\,X_2\in B)  &= \sum_{x_1\in A}\sum_{x_2\in B} \Pr(X_1=x_1,\,X_2=x_2)\\
&= \sum_{x_1\in A}\sum_{x_2\in B} \Pr(X_1=x_1)\Pr(X_2=x_2)\\
&= \Pr(X_1\in A)\Pr(X_2\in B)
\end{align*}
:::

::: {#exm-ind-rv}
### 二回のコイン投げ
標本空間を $\Omega = \{\mathrm{HH},\mathrm{HT},\mathrm{TH},\mathrm{TT}\}$ とし、確率測度を $P(A) = \frac{|A|}4\quad\forall A\subseteq\Omega$ とする。
\begin{align*}
X_1(\mathrm{HH})&=X_1(\mathrm{HT}) = 1,&
X_1(\mathrm{TH})&=X_1(\mathrm{TT}) = 0\\
X_2(\mathrm{HH})&=X_2(\mathrm{TH}) = 1,&
X_2(\mathrm{HT})&=X_2(\mathrm{TT}) = 0
\end{align*}
と定義する。
このとき、
\begin{align*}
f_{X_1,\,X_2}(x_1,\,x_2) &= \frac14\qquad\forall x_1,x_2\in\{0,1\}\\
f_{X_1}(x_1)=f_{X_2}(x_2)&=\frac12\qquad\forall x_1,x_2\in\{0,1\}
\end{align*}
より $f_{X_1,\,X_2}(x_1,\,x_2) = f_{X_1}(x_1)f_{X_2}(x_2)$ を満たすことが分かる。
よって確率変数 $X_1,\,X_2$ は独立である。
:::

## 連続型確率変数と確率密度関数
確率空間 $(\Omega,\,P)$ 上の連続型確率変数 $X_1$, $X_2$ について、**同時確率密度関数**を
\begin{align*}
\Pr(\begin{bmatrix}X_1,\,X_2\end{bmatrix}\in A) &= \int_A f_{X_1,\,X_2}(x_1,x_2)\mathrm{d}x_1\mathrm{d}x_2
\end{align*}
を満たすものと定義する。
$X_1$ と $X_2$ が確率密度関数を持つ場合でも $X_1$ と $X_2$ の同時確率密度関数が存在するとは限らない。
