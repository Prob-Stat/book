# 正規分布と中心極限定理

## 中心極限定理

大数の法則により $\frac1N\sum_{k=1}^N X_k$ は期待値周辺に集中することが分かる。
また、クラメールの定理によりその集中のスピードも精密に評価することができる。
一方で期待値周辺の挙動を
\begin{align*}
\frac1{\sqrt{N}}\left(\sum_{k=1}^N X_k-N\expt{X}\right)
\end{align*}
より詳しく見る。

::: {#thm-clt}
### 中心極限定理

確率変数 $X$ が**分散を持つ**とする。
確率変数 $X_1,\dotsc,X_N$ が独立で $X$ と同じ分布に従うとする。
また、確率変数 $Z$ は期待値0分散1の正規分布 $N(0,1)$ に従うものとする。
このとき、
\begin{align*}
\lim_{N\to\infty} \Pr\left(\frac1{\sqrt{N\var{X}}}\left(\sum_{k=1}^N X_k-N\expt{X}\right)\le x\right)
&= \Pr(Z\le x) \qquad\forall x\in\mathbb{R}.
\end{align*}
:::

確率変数 $X_k$ を期待値0分散1に正規化した確率変数
\begin{align*}
Y_k &\coloneqq \frac{X_k -\expt{X}}{\sqrt{\var{X}}}
\end{align*}
を使うと、
\begin{align*}
\lim_{N\to\infty} F_{\frac{\sum_k Y_k}{\sqrt{N}}}(x)
&= F_Z(x)\qquad\forall x\in\mathbb{R}
\end{align*}

## 特性関数

::: {#def-cf}
確率変数 $X$ について、特性関数 $\varphi_X\colon\mathbb{R}\to\mathbb{C}$ を以下で定義する。
\begin{align*}
\varphi_X(t) &\coloneqq \expt{\mathrm{e}^{itX}}.
\end{align*}
:::

::: {#thm-cf}
確率変数 $X,\,Y$ について
\begin{align*}
\varphi_X = \varphi_Y &\iff F_X = F_Y.
\end{align*}
:::
::: {.proof}
### 確率変数の像が有限の場合の証明

$\mathrm{Image}(X)$ と $\mathrm{Image}(Y)$ が有限の場合に限って証明を与える。
\begin{align*}
\{x_0,\dotsc,x_{N-1}\} &\coloneqq \mathrm{Image}(X) \cup \mathrm{Image}(Y)
\end{align*}
とする。
\begin{align*}
\varphi_X(t) &= \sum_{k=0}^{N-1} f_X(x_k) \mathrm{e}^{itx_k},&
\varphi_Y(t) &= \sum_{k=0}^{N-1} f_Y(x_k) \mathrm{e}^{itx_k}
\end{align*}
なので、
\begin{align*}
0 = \varphi_X(t) - \varphi_Y(t) &= \sum_{k=0}^{N-1} (f_X(x_k)-f_Y(x_k)) \mathrm{e}^{itx_k}
\qquad\forall t\in\mathbb{R}.
\end{align*}
よって、
\begin{align}
\sum_{k=0}^{N-1} (f_X(x_k)-f_Y(x_k)) \mathrm{e}^{i\ell x_k}&=0\qquad\forall \ell\in\{0,1,\dotsc,N-1\}
\end{align}
である。
ここで、$N\times N$ 実行列 $V$ を
\begin{align*}
V_{\ell k} &= \mathrm{e}^{i\ell x_k}
\qquad\forall k,\ell\in\{0,1,\dotsc,N-1\}
\end{align*}
とおく。
この行列 $V$ は Vandermonde行列の転置であり正則なので、
\begin{align*}
&\sum_{k=0}^{N-1} V_{\ell k} g_k=0\qquad\forall \ell\in\{0,1,\dotsc,N-1\}\\
\implies& g_k = 0 \qquad\forall k\in\{0,1,\dotsc,N-1\}
\end{align*}
よって、
\begin{align*}
f_X(x_k) &= f_Y(x_k) \qquad\forall k\in\{0,1,\dotsc,N-1\}
\end{align*}
である。
:::

## 特性関数の応用

正規分布の再生性は愚直に確率密度関数の畳み込みを計算しても確認できるが、特性関数と @thm-cf を用いると簡単に証明できる。

:::{#lem-normal}
### 正規分布の再生性

独立確率変数 $X\sim N(\mu_0,\,\sigma_0^2)$ と $Y\sim N(\mu_1,\,\sigma_1^2)$ について
$X+Y\sim N(\mu_0+\mu_1,\,\sigma_0^2+\sigma_1^2)$.
:::
:::{.proof}
\begin{align*}
\varphi_X(t) &= \mathrm{e}^{i\mu_0 t - \frac12\sigma_0^2 t^2}&
\varphi_Y(t) &= \mathrm{e}^{i\mu_1 t - \frac12\sigma_1^2 t^2}
\end{align*}
より、
\begin{align*}
\varphi_{X+Y}(t) &= \varphi_X(t)\varphi_Y(t) =
\mathrm{e}^{i(\mu_0+\mu_1) t - \frac12(\sigma_0^2+\sigma_1^2) t^2}
\end{align*}
であるが、これは $N(\mu_0+\mu_1,\,\sigma_0^2+\sigma_1^2)$ の特性関数である。
よって、@thm-cf より
$X+Y\sim N(\mu_0+\mu_1,\,\sigma_0^2+\sigma_1^2)$.
:::

:::{#lem-normal}
### ポアソン分布の再生性

独立確率変数 $X\sim \mathrm{Poisson}(\lambda_0)$ と $Y\sim \mathrm{Poisson}(\lambda_1)$ について
$X+Y\sim \mathrm{Poisson}(\lambda_0+\lambda_1)$.
:::
:::{.proof}
\begin{align*}
\varphi_X(t) &= \mathrm{e}^{\lambda_0(\mathrm{e}^{it}-1)}&
\varphi_Y(t) &= \mathrm{e}^{\lambda_1(\mathrm{e}^{it}-1)}&
\end{align*}
より、
\begin{align*}
\varphi_{X+Y}(t) &= \varphi_X(t)\varphi_Y(t) =
\mathrm{e}^{(\lambda_0+\lambda_1)(\mathrm{e}^{it}-1)}&
\end{align*}
であるが、これは $\mathrm{Poisson}(\lambda_0+\lambda_1)$ の特性関数である。
よって、@thm-cf より
$X+Y\sim \mathrm{Poisson}(\lambda_0+\lambda_1)$.
:::

## 連続性定理
## 中心極限定理の証明
